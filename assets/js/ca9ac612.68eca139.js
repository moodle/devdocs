(self.webpackChunkdevdocs=self.webpackChunkdevdocs||[]).push([[10094],{88698:function(e,t,n){"use strict";var a=n(75963);t.Z=void 0;var i=a(n(64938)),o=n(85893),l=(0,i.default)((0,o.jsx)("path",{d:"M5 13.18v4L12 21l7-3.82v-4L12 17l-7-3.82zM12 3 1 9l11 6 9-4.91V17h2V9L12 3z"}),"School");t.Z=l},60620:function(e,t,n){"use strict";n.d(t,{nR:function(){return s}});var a=n(67294),i=n(80069),o=n(3905),l=n(78989),r=function(e){return"boolean"!=typeof e&&e?"string"==typeof e||a.isValidElement(e)?a.createElement(o.Zo,null,e):a.createElement(o.Zo,null,a.createElement(e,null)):null},s=function(e){var t,n,s,p=function(e){return Object.assign({filetype:"php",examplePurpose:e.summary},e)}(Object.assign({examplePurpose:null!=(t=null==e?void 0:e.summary)?t:null},e));(p.description=function(e,t){var n=e.description,i=void 0===n?null:n,l=e.extraDescription,s=void 0===l?null:l,p=e.children,d=void 0===p?null:p;if(d){var c=r(d);return a.createElement(o.Zo,null,c)}if(i){var m=r(i);return a.createElement(o.Zo,null,m)}var u=r(t),h=r(s);return u?a.createElement(o.Zo,null,u,h):null}(p,null!=(n=null==p?void 0:p.defaultDescription)?n:null),null!=p&&p.example||null!=p&&p.defaultExample)&&(p.example=(0,l.W7)(p,null!=(s=null==p?void 0:p.defaultExample)?s:null));return(0,i.Z)(p)}},95757:function(e,t,n){"use strict";n.d(t,{D5:function(){return u},dk:function(){return k},i9:function(){return x},Jk:function(){return C},Id:function(){return L},MC:function(){return $},tw:function(){return O},_n:function(){return G},c5:function(){return Q},Hg:function(){return ie},BO:function(){return pe},L5:function(){return he},oI:function(){return be},sY:function(){return Me},T5:function(){return Ze},ss:function(){return Ie},Uo:function(){return ze},Gf:function(){return Fe},KQ:function(){return je},Y1:function(){return et},J$:function(){return ot},t5:function(){return dt},Wy:function(){return gt},dU:function(){return yt},NA:function(){return _t},ZA:function(){return Pt},f_:function(){return Bt},My:function(){return Ht}});var a=n(83117),i=n(67294),o=n(60620),l=n(80102),r=n(3905),s=n(13904),p=["components"],d={},c={toc:[]};function m(e){var t=e.components,n=(0,l.Z)(e,p);return(0,r.kt)("wrapper",(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)(s.Z,(0,a.Z)({frontMatter:d},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,r.kt)("p",null,"JavaScript in Moodle is written in the ESM format, and transpiled into AMD modules for deployment."),(0,r.kt)("p",null,"The ",(0,r.kt)("a",{parentName:"p",href:"../guides/javascript"},"Moodle JavaScript Guide")," has detailed information and examples on writing JavaScript in Moodle. Further information is also available in the ",(0,r.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Javascript_Modules"},"JavaScript Modules")," documentation."),(0,r.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Although the AMD module format is supported, all new JavaScript is written in the EcmaScript Module (ESM) format."))))}m.isMDXComponent=!0;var u=function(e){return i.createElement(o.nR,(0,a.Z)({required:!0,defaultDescription:m,defaultExample:"\nimport {fetchThings} from './repository';\n\nexport const updateThings = (thingData) => {\n    return fetchThings(thingData);\n};\n",examplePurpose:"Example module",filepath:"/amd/src/example.js",filetype:"js",modulename:"example",summary:"AMD JavaScript Modules"},e))},h=["components"],g={},f={toc:[]};function v(e){var t=e.components,n=(0,l.Z)(e,h);return(0,r.kt)("wrapper",(0,a.Z)({},f,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)(s.Z,(0,a.Z)({frontMatter:g},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,r.kt)("p",null,"If your plugin stores data then you may need to implement the Backup feature which allows the activity to backed up, restored, and duplicated."),(0,r.kt)("p",null,"For more information on Backup and restore, see the following:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://docs.moodle.org/dev/Backup_2.0_for_developers"},"Backup 2.0 for developers")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://docs.moodle.org/dev/Restore_2.0_for_developers"},"Restore 2.0 for developers"))))}v.isMDXComponent=!0;var k=function(e){return i.createElement(o.nR,(0,a.Z)({filepath:"/backup/",summary:"Plugin Backup configuration",defaultDescription:v},e))},b=["components"],y={},N={toc:[]};function w(e){var t=e.components,n=(0,l.Z)(e,b);return(0,r.kt)("wrapper",(0,a.Z)({},N,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)(s.Z,(0,a.Z)({frontMatter:y},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,r.kt)("p",null,"For plugins which make use of ",(0,r.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/CLI_scripts"},"CLI scripts"),", the convention is that these are placed into the ",(0,r.kt)("inlineCode",{parentName:"p"},"cli")," folder to make their purpose clear, and easy to find."),(0,r.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"All CLI scripts ",(0,r.kt)("strong",{parentName:"p"},"must")," declare themselves as being a CLI script by defining the ",(0,r.kt)("inlineCode",{parentName:"p"},"CLI_SCRIPT")," constant to true before including ",(0,r.kt)("inlineCode",{parentName:"p"},"config.php"),"."))))}w.isMDXComponent=!0;var x=function(e){return i.createElement(o.nR,(0,a.Z)({filepath:"/cli/",summary:"CLI scripts",exampleFilepath:"/cli/example.php",examplePurpose:"Example CLI script",defaultDescription:w,defaultExample:"define('CLI_SCRIPT', true);\n\nrequire_once(__DIR__ . '/../../config.php');\nrequire_once(\"{$CFG->libdir}/clilib.php\");\n\n// Your CLI features go here.\n"},e))},M=["components"],_={},T={toc:[]};function E(e){var t=e.components,n=(0,l.Z)(e,M);return(0,r.kt)("wrapper",(0,a.Z)({},T,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)(s.Z,(0,a.Z)({frontMatter:_},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,r.kt)("p",null,"If your plugin includes a changelog in its root directory, this will be used to automatically pre-fill the release notes field when uploading new versions of your plugin to the ",(0,r.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Plugins_directory"},"Plugins directory"),". This file can be in any of the following locations:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"CHANGES.md"),": as a markdown file; or"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"CHANGES.txt"),": as a text file; or"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"CHANGES.html"),": as an HTML file; or"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"CHANGES"),": as a text file.")))}E.isMDXComponent=!0;var C=function(e){return i.createElement(o.nR,(0,a.Z)({filepath:"/CHANGES",filetype:"php",summary:"Plugin changelog",recommended:!0,defaultDescription:E},e))},Z=["components"],P={},A={toc:[]};function D(e){var t=e.components,n=(0,l.Z)(e,Z);return(0,r.kt)("wrapper",(0,a.Z)({},A,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)(s.Z,(0,a.Z)({frontMatter:P},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,r.kt)("p",null,"Moodle supports, and recommends, the use of autoloaded PHP classes."),(0,r.kt)("p",null,"By placing files within the ",(0,r.kt)("inlineCode",{parentName:"p"},"classes")," directory or appropriate sub-directories, and with the correct PHP Namespace, and class name, Moodle is able to autoload classes without the need to manually require, or include them."),(0,r.kt)("p",null,"Details on these rules and conventions are available in the following documentation:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/general/development/policies/codingstyle#namespaces"},"Coding style - namespace conventions")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://docs.moodle.org/dev/Automatic_class_loading"},"Automatic class loading"))))}D.isMDXComponent=!0;var L=function(e){return i.createElement(o.nR,(0,a.Z)({filepath:"/classes/",summary:"Autoloaded classes",defaultDescription:D},e))},I=["components"],B={},S={toc:[]};function R(e){var t=e.components,n=(0,l.Z)(e,I);return(0,r.kt)("wrapper",(0,a.Z)({},S,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)(s.Z,(0,a.Z)({frontMatter:B},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"db/access.php")," file contains the ",(0,r.kt)("strong",{parentName:"p"},"initial")," configuration for a plugin's access control rules."),(0,r.kt)("p",null,"Access control is handled in Moodle by the use of Roles, and Capabilities. You can read more about these in the ",(0,r.kt)("a",{parentName:"p",href:"/devdocs/docs/apis/subsystems/access"},"Access API")," documentation."),(0,r.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"Changing initial configuration")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"If you make changes to the initial configuration of ",(0,r.kt)("em",{parentName:"p"},"existing")," access control rules, these will only take effect for ",(0,r.kt)("em",{parentName:"p"},"new installations of your plugin"),". Any existing installation ",(0,r.kt)("strong",{parentName:"p"},"will not")," be updated with the latest configuration."),(0,r.kt)("p",{parentName:"div"},"Updating existing capability configuration for an installed site is not recommended as it may have already been modified by an administrator."))))}R.isMDXComponent=!0;var $=function(e){return i.createElement(o.nR,(0,a.Z)({defaultDescription:R,defaultExample:"$capabilities = [\n    // Ability to use the plugin.\n    'plugintype/pluginname:useplugininstance' => [\n        'riskbitmask' => RISK_XSS,\n        'captype' => 'write',\n        'contextlevel' => CONTEXT_COURSE,\n        'archetypes' => [\n            'manager' => CAP_ALLOW,\n            'editingteacher' => CAP_ALLOW,\n        ],\n    ],\n];\n",filepath:"/db/access.php",summary:"Plugin capabilities",examplePurpose:"Plugin capabilities"},e))},z=["components"],H={},X={toc:[]};function U(e){var t=e.components,n=(0,l.Z)(e,z);return(0,r.kt)("wrapper",(0,a.Z)({},X,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)(s.Z,(0,a.Z)({frontMatter:H},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,r.kt)("p",null,"Moodle supports a feature known as ",(0,r.kt)("em",{parentName:"p"}," ",(0,r.kt)("a",{parentName:"em",href:"https://docs.moodle.org/dev/Events_API#Event_observers"},"Event observers")," ")," to allow components to make changes when certain events take place."),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"db/events.php")," file allows you define any event subscriptions that your plugin needs to listen for."),(0,r.kt)("p",null,"Event subscriptions are a convenient way to observe events generated elsewhere in Moodle."),(0,r.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"Communication between components")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"You ",(0,r.kt)("em",{parentName:"p"},"should not")," use event subscriptions to subscribe to events belonging to other plugins, without defining a dependency upon that plugin."),(0,r.kt)("p",{parentName:"div"},"See the ",(0,r.kt)("a",{parentName:"p",href:"/general/development/policies/component-communication#event-observers"},"Component communication principles")," documentation for a description of some of the risks of doing so."))))}U.isMDXComponent=!0;var O=function(e){return i.createElement(o.nR,(0,a.Z)({refreshedDuringUpgrade:!0,defaultDescription:U,defaultExample:"$observers = [\n    [\n        'eventname' => '\\core\\event\\course_module_created',\n        'callback'  => '\\plugintype_pluginname\\event\\observer\\course_module_created::store',\n        'priority'  => 1000,\n    ],\n];\n",filepath:"/db/events.php",summary:"Event observer definitions",examplePurpose:"Event observer definitions"},e))},F=["components"],Y={},q={toc:[]};function V(e){var t=e.components,n=(0,l.Z)(e,F);return(0,r.kt)("wrapper",(0,a.Z)({},q,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)(s.Z,(0,a.Z)({frontMatter:Y},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"db/install.php")," file allows you define a post-installation hook, which is called immediately after the initial creation of your database schema."),(0,r.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"This file is not used at all after the ",(0,r.kt)("em",{parentName:"p"},"initial")," installation of your plugin."),(0,r.kt)("p",{parentName:"div"},"It is ",(0,r.kt)("em",{parentName:"p"},"not called")," during any upgrade."))))}V.isMDXComponent=!0;var G=function(e){return i.createElement(o.nR,(0,a.Z)({defaultDescription:V,filepath:"/CHANGES",filetype:"php",summary:"Post-installation hook"},e))},j=["components"],W={},J={toc:[]};function K(e){var t=e.components,n=(0,l.Z)(e,j);return(0,r.kt)("wrapper",(0,a.Z)({},J,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)(s.Z,(0,a.Z)({frontMatter:W},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"install.xml")," file is used to define any database tables, fields, indexes, and keys, which should be created for a plugin during its initial installation."),(0,r.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"When creating or updating the ",(0,r.kt)("inlineCode",{parentName:"p"},"install.xml")," you ",(0,r.kt)("strong",{parentName:"p"},"must")," use the built-in ",(0,r.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/XMLDB_Documentation"},"XMLDB editor")," within Moodle."))))}K.isMDXComponent=!0;var Q=function(e){return i.createElement(o.nR,(0,a.Z)({filepath:"/db/install.xml",summary:"Database schema",examplePurpose:"Database schema",defaultDescription:K},e))},ee=["components"],te={},ne={toc:[]};function ae(e){var t=e.components,n=(0,l.Z)(e,ee);return(0,r.kt)("wrapper",(0,a.Z)({},ne,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)(s.Z,(0,a.Z)({frontMatter:te},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"db/messages.php")," file allows you to declare the messages that your plugin sends."),(0,r.kt)("p",null,"See the ",(0,r.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Message_API"},"Message API")," documentation for further information."))}ae.isMDXComponent=!0;var ie=function(e){return i.createElement(o.nR,(0,a.Z)({refreshedDuringUpgrade:!0,defaultExample:"\n$messageproviders = [\n    'things' => [\n        'defaults' => [\n            'airnotifier' => MESSAGE_PERMITTED + MESSAGE_DEFAULT_ENABLED,\n        ],\n    ],\n];\n",defaultDescription:ae,filepath:"/db/messages.php",summary:"Message provider configuration",examplePurpose:"Message provider configuration"},e))},oe=["components"],le={},re={toc:[]};function se(e){var t=e.components,n=(0,l.Z)(e,oe);return(0,r.kt)("wrapper",(0,a.Z)({},re,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)(s.Z,(0,a.Z)({frontMatter:le},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,r.kt)("p",null,"The Moodle Mobile remote add-on is the mobile app version of the plugin that will be loaded when a user accesses the plugin on the app."),(0,r.kt)("p",null,"A plugin can include several Mobile add-ons. Each add-on must indicate a unique name."),(0,r.kt)("p",null,"See the ",(0,r.kt)("a",{parentName:"p",href:"../../moodleapp/development/plugins-development-guide"},"Moodle App Plugins development guide")," for more information on configuring your plugin for the Moodle App."))}se.isMDXComponent=!0;var pe=function(e){return i.createElement(o.nR,(0,a.Z)({refreshedDuringUpgrade:!0,defaultDescription:se,filepath:"/db/mobile.php",summary:"MoodleMobile version of the plugin"},e))},de=["components"],ce={},me={toc:[]};function ue(e){var t=e.components,n=(0,l.Z)(e,de);return(0,r.kt)("wrapper",(0,a.Z)({},me,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)(s.Z,(0,a.Z)({frontMatter:ce},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,r.kt)("p",null,"Details of classes that have been renamed to fit in with autoloading. See ",(0,r.kt)("a",{parentName:"p",href:"https://moodle.org/mod/forum/discuss.php?d=262403"},"forum discussion")," for details."))}ue.isMDXComponent=!0;var he=function(e){return i.createElement(o.nR,(0,a.Z)({refreshedDuringPurge:!0,defaultExample:"\ndefined('MOODLE_INTERNAL') || die;\n\n$renamedclasses = [\n    'old_class_name' => 'fully_qualified\\\\new\\\\name',\n\n    // Examples:\n    'assign_header' => 'mod_assign\\\\output\\\\header',\n    '\\assign_header' => 'mod_assign\\\\output\\\\header',\n    '\\assign' => 'mod_assign\\\\assignment',\n\n    // Incorrect:\n    // The new class name should _not_ have a leading \\.\n    'assign_header' => '\\\\mod_assign\\\\output\\\\header',\n];\n",defaultDescription:ue,filepath:"/db/renamedclasses.php",summary:"Renamed classes",examplePurpose:"Renamed classes"},e))},ge=["components"],fe={},ve={toc:[]};function ke(e){var t=e.components,n=(0,l.Z)(e,ge);return(0,r.kt)("wrapper",(0,a.Z)({},ve,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)(s.Z,(0,a.Z)({frontMatter:fe},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"db/services.php")," file is used to describe the external functions available for use in web services. This includes\nweb service functions defined for javascript, and for the ",(0,r.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Moodle_Mobile_App"},"Moodle Mobile App"),"."),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Web services should be named following the ",(0,r.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Web_service_API_functions#Naming_convention"},"naming convention for web services"),"."))),(0,r.kt)("p",null,"For further information on external functions and web services, see:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://docs.moodle.org/dev/Adding_a_web_service_to_a_plugin"},"Adding a web service to a plugin")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://docs.moodle.org/dev/Web_services_API"},"Web services API")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://docs.moodle.org/dev/External_functions_API"},"External functions API"))))}ke.isMDXComponent=!0;var be=function(e){return i.createElement(o.nR,(0,a.Z)({refreshedDuringUpgrade:!0,recommended:!0,filepath:"/db/services.php",summary:"Web service function declarations",examplePurpose:"Web service function declarations",defaultExample:"\n$functions = [\n    'plugintype_pluginname_create_things' => [\n        'classname' => 'plugintype_pluginname\\external\\create_things',\n        'methodname' => 'execute',\n        'description' => 'Create a new thing',\n        'type' => 'write',\n        'capabilities' => 'plugintype/pluginname:create_things',\n        'ajax' => true,\n        'services' => [\n            MOODLE_OFFICIAL_MOBILE_SERVICE,\n        ],\n    ],\n];\n",defaultDescription:ke},e))},ye=["components"],Ne={},we={toc:[]};function xe(e){var t=e.components,n=(0,l.Z)(e,ye);return(0,r.kt)("wrapper",(0,a.Z)({},we,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)(s.Z,(0,a.Z)({frontMatter:Ne},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"db/uninstall.php")," file allows you define a pre-uninstallation hook, which is called immediately before all table and data from your plugin are removed."))}xe.isMDXComponent=!0;var Me=function(e){return i.createElement(o.nR,(0,a.Z)({defaultDescription:xe,filepath:"/db/uninstall.php",filetype:"php",summary:"Pre-uninstallation hook"},e))},_e=["components"],Te={},Ee={toc:[]};function Ce(e){var t=e.components,n=(0,l.Z)(e,_e);return(0,r.kt)("wrapper",(0,a.Z)({},Ee,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)(s.Z,(0,a.Z)({frontMatter:Te},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"db/upgrade.php")," file contains upgrade steps, including database schema changes, changes to settings, and other steps which must be performed during upgrade."),(0,r.kt)("p",null,"See the ",(0,r.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Upgrade_API"},"Upgrade API")," documentation for further information."),(0,r.kt)("div",{className:"admonition admonition-danger alert alert--danger"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"Generating Database Schema changes")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"When making changes to the database schema you ",(0,r.kt)("strong",{parentName:"p"},"must")," use the build-in ",(0,r.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/XMLDB_Documentation"},"XMLDB editor")," within\nMoodle. This can be used to generate php upgrade steps."),(0,r.kt)("p",{parentName:"div"},"The ",(0,r.kt)("a",{parentName:"p",href:"#dbinstallxml"},"install.xml")," schema must match the schema generated by the upgrade at all times."))),(0,r.kt)("p",null,"To create an upgrade step you must:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Use the ",(0,r.kt)("a",{parentName:"li",href:"https://docs.moodle.org/dev/XMLDB_editor"},"XMLDB editor")," to create the definition of the new fields"),(0,r.kt)("li",{parentName:"ol"},"Update the ",(0,r.kt)("inlineCode",{parentName:"li"},"install.xml")," from the XMLDB editor"),(0,r.kt)("li",{parentName:"ol"},"Generate the PHP upgrade steps from within the XMLDB Editor"),(0,r.kt)("li",{parentName:"ol"},"Update the version number in your ",(0,r.kt)("inlineCode",{parentName:"li"},"version.php"))),(0,r.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"In many cases you will be able to combine multiple upgrade steps into a single version change."))),(0,r.kt)("p",null,"When a version number increment is detected during an upgrade, the ",(0,r.kt)("inlineCode",{parentName:"p"},"xmldb_[pluginname]_upgrade")," function is called with the old version number as the first argument."),(0,r.kt)("p",null,"See the ",(0,r.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Upgrade_API"},"Upgrade API")," documentation for more information on the upgrade process."))}Ce.isMDXComponent=!0;var Ze=function(e){return i.createElement(o.nR,(0,a.Z)({recommended:!0,defaultDescription:Ce,defaultExample:"\nfunction xmldb_certificate_upgrade($oldversion = 0) {\n    if ($oldversion < 2012091800) {\n        // Add new fields to certificate table.\n        $table = new xmldb_table('certificate');\n        $field = new xmldb_field('showcode');\n        $field->set_attributes(XMLDB_TYPE_INTEGER, '1', XMLDB_UNSIGNED, XMLDB_NOTNULL, null, '0', 'savecert');\n        if (!$dbman->field_exists($table, $field)) {\n            $dbman->add_field($table, $field);\n        }\n        // Add new fields to certificate_issues table.\n        $table = new xmldb_table('certificate_issues');\n        $field = new xmldb_field('code');\n        $field->set_attributes(XMLDB_TYPE_CHAR, '50', null, null, null, null, 'certificateid');\n        if (!$dbman->field_exists($table, $field)) {\n            $dbman->add_field($table, $field);\n        }\n\n        // Certificate savepoint reached.\n        upgrade_mod_savepoint(true, 2012091800, 'certificate');\n    }\n}",filepath:"/db/upgrade.php",summary:"Upgrade steps",examplePurpose:"Upgrade steps"},e))},Pe=["components"],Ae={},De={toc:[]};function Le(e){var t=e.components,n=(0,l.Z)(e,Pe);return(0,r.kt)("wrapper",(0,a.Z)({},De,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)(s.Z,(0,a.Z)({frontMatter:Ae},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,r.kt)("p",null,"A plugin can declare its own environment requirements, in addition to those declared by Moodle core. These may includes features such as PHP extension requirements, version requirements, and similar items."),(0,r.kt)("p",null,"Further information on this file and its format can be found in the ",(0,r.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Environment_checking"},"Environment checking")," documentation."))}Le.isMDXComponent=!0;var Ie=function(e){return i.createElement(o.nR,(0,a.Z)({showFileHeader:!1,showLicense:!1,refreshedDuringUpgrade:!0,filepath:"/environment.xml",filetype:"xml",summary:"Plugin-specific environment requirements",defaultDescription:Le,defaultExample:'\n<?xml version="1.0" encoding="UTF-8" ?>\n<COMPATIBILITY_MATRIX>\n  <PLUGIN name="plugintype_pluginname">\n    <PHP_EXTENSIONS>\n      <PHP_EXTENSION name="soap" level="required">\n      </PHP_EXTENSION>\n    </PHP_EXTENSIONS>\n  </PLUGIN>\n</COMPATIBILITY_MATRIX>'},e))},Be=["components"],Se={},Re={toc:[]};function $e(e){var t=e.components,n=(0,l.Z)(e,Be);return(0,r.kt)("wrapper",(0,a.Z)({},Re,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)(s.Z,(0,a.Z)({frontMatter:Se},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,r.kt)("p",null,"Each plugin must define a set of language strings with, at a minimum, an English translation. These are specified in the plugin's ",(0,r.kt)("inlineCode",{parentName:"p"},"lang/en")," directory in a file named after the plugin. For example the LDAP authentication plugin:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-php"},"// Plugin type: `auth`\n// Plugin name: `ldap`\n// Frankenstyle plugin name: `auth_ldap`\n// Plugin location: `auth/ldap`\n// Language string location: `auth/ldap/lang/en/auth_ldap.php`\n")),(0,r.kt)("div",{className:"admonition admonition-warning alert alert--danger"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Every plugin ",(0,r.kt)("em",{parentName:"p"},"must")," define the name of the plugin, or its ",(0,r.kt)("inlineCode",{parentName:"p"},"pluginname"),"."))),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"get_string")," API can be used to translate a string identifier back into a translated string."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"get_string('pluginname', '[plugintype]_[pluginname]');\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"See the ",(0,r.kt)("a",{parentName:"li",href:"https://docs.moodle.org/dev/String_API#Adding_language_file_to_plugin"},"String API")," documentation for more information on language files.")))}$e.isMDXComponent=!0;var ze=function(e){return i.createElement(o.nR,(0,a.Z)({filepath:"/lang/en/plugintype_pluginname.php",refreshedDuringPurge:!0,required:!0,summary:"Language files",examplePurpose:"Languages configuration",defaultDescription:$e,defaultExample:"$string['pluginname'] = 'The name of my plugin will go here';"},e))},He=["components"],Xe={},Ue={toc:[]};function Oe(e){var t=e.components,n=(0,l.Z)(e,He);return(0,r.kt)("wrapper",(0,a.Z)({},Ue,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)(s.Z,(0,a.Z)({frontMatter:Xe},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"lib.php")," file is a legacy file which acts as a bridge between Moodle core, and the plugin. In recent plugins it is should only used to define callbacks and related functionality which currently is not supported as an auto-loadable class."),(0,r.kt)("p",null,"All functions defined in this file ",(0,r.kt)("strong",{parentName:"p"},"must")," meet the requirements set out in the relevant section of the ",(0,r.kt)("a",{parentName:"p",href:"/general/development/policies/codingstyle#Functions-and-Methods"},"Coding style"),"."),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"Performance impact")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Moodle core often loads all the ",(0,r.kt)("tt",null,"lib.php")," files of a given plugin types. For performance reasons, it is strongly recommended to keep this file as small as possible and have just required code implemented in it. All the plugin's internal logic should be implemented in the auto-loaded classes."))))}Oe.isMDXComponent=!0;var Fe=function(e){return i.createElement(o.nR,(0,a.Z)({legacy:!0,required:!1,filepath:"/lib.php",summary:"Global plugin functions",examplePurpose:"Plugin functions",defaultDescription:Oe},e))},Ye=["components"],qe={},Ve={toc:[]};function Ge(e){var t=e.components,n=(0,l.Z)(e,Ye);return(0,r.kt)("wrapper",(0,a.Z)({},Ve,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)(s.Z,(0,a.Z)({frontMatter:qe},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,r.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"Legacy feature")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"The use of this file is no longer recommended, and new uses of it will not be permitted in core code."))),(0,r.kt)("p",null,"Rather than creating global functions in a global namespace in a ",(0,r.kt)("tt",null,"locallib.php")," file, you should use autoloaded classes which are located in the ",(0,r.kt)("tt",null,"classes/")," directory."),(0,r.kt)("p",null,"Where this file is in use, all functions ",(0,r.kt)("strong",{parentName:"p"},"must")," meet the requirements set out in the relevant section of the ",(0,r.kt)("a",{parentName:"p",href:"/general/development/policies/codingstyle#Functions-and-Methods"},"Coding style")),(0,r.kt)("p",null,"Existing functions which have been incorrectly named ",(0,r.kt)("strong",{parentName:"p"},"will not")," be accepted as an example of an existing convention. Existing functions which are incorrectly named ",(0,r.kt)("strong",{parentName:"p"},"should")," be converted to use a namespaced class."))}Ge.isMDXComponent=!0;var je=function(e){return i.createElement(o.nR,(0,a.Z)({defaultDescription:Ge,filepath:"/locallib.php",legacy:!0,required:!1,summary:"Global support functions"},e))},We=["components"],Je={},Ke={toc:[]};function Qe(e){var t=e.components,n=(0,l.Z)(e,We);return(0,r.kt)("wrapper",(0,a.Z)({},Ke,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)(s.Z,(0,a.Z)({frontMatter:Je},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,r.kt)("p",null,"Plugins can provide icons in several formats, and most plugin types require that a default icon be provided."),(0,r.kt)("p",null,"Where a browser supports it, the ",(0,r.kt)("inlineCode",{parentName:"p"},"svg")," format is used, falling back to ",(0,r.kt)("inlineCode",{parentName:"p"},"png")," formats when an SVG is unavailable."),(0,r.kt)("p",null,"Full details of the correct naming, sizing, and design guidelines for icons in Moodle can be found in the ",(0,r.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Moodle_icons"},"Moodle icons")," documentation."))}Qe.isMDXComponent=!0;var et=function(e){return i.createElement(o.nR,(0,a.Z)({defaultDescription:Qe,refreshedDuringPurge:!0,filepath:"/pix/",summary:"Plugins icons"},e))},tt=["components"],nt={},at={toc:[]};function it(e){var t=e.components,n=(0,l.Z)(e,tt);return(0,r.kt)("wrapper",(0,a.Z)({},at,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)(s.Z,(0,a.Z)({frontMatter:nt},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,r.kt)("p",null,"We recommend that you include any additional information for your plugin in a project readme file. Ideally this should act as an offline version of all information in your plugin's page in the ",(0,r.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Plugins_directory"},"Plugins directory"),"."),(0,r.kt)("p",null,"We recommend creating your readme file in either a ",(0,r.kt)("inlineCode",{parentName:"p"},"README.md"),", or ",(0,r.kt)("inlineCode",{parentName:"p"},"README.txt")," format."))}it.isMDXComponent=!0;var ot=function(e){return i.createElement(o.nR,(0,a.Z)({filepath:"/README",recommended:!0,defaultDescription:it,summary:"Plugin Information for Administrators"},e))},lt=["components"],rt={},st={toc:[]};function pt(e){var t=e.components,n=(0,l.Z)(e,lt);return(0,r.kt)("wrapper",(0,a.Z)({},st,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)(s.Z,(0,a.Z)({frontMatter:rt},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,r.kt)("p",null,"When importing a third-party library into your plugin, it is advisable to create a ",(0,r.kt)("inlineCode",{parentName:"p"},"readme_moodle.txt")," file detailing relevant information, including:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Download URLs"),(0,r.kt)("li",{parentName:"ul"},"Build instructions")))}pt.isMDXComponent=!0;var dt=function(e){return i.createElement(o.nR,(0,a.Z)({recommended:!0,filepath:"/*/readme_moodle.txt",defaultDescription:pt,summary:"Third-party library import instructions"},e))},ct=["components"],mt={},ut={toc:[]};function ht(e){var t=e.components,n=(0,l.Z)(e,ct);return(0,r.kt)("wrapper",(0,a.Z)({},ut,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)(s.Z,(0,a.Z)({frontMatter:mt},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,r.kt)("p",null,"You can define settings for your plugin that the administrator can configure by creating a ",(0,r.kt)("inlineCode",{parentName:"p"},"settings.php")," file in the root of your plugins' directory."),(0,r.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Settings must named in the following format:"),(0,r.kt)("pre",{parentName:"div"},(0,r.kt)("code",{parentName:"pre"},"plugintype_pluginname/settingname\n")),(0,r.kt)("p",{parentName:"div"},"By following the correct naming, all settings will automatically be stored in the ",(0,r.kt)("inlineCode",{parentName:"p"},"config_plugins")," database table."))),(0,r.kt)("p",null,"Full details on how to create settings are available in the ",(0,r.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Admin_settings"},"Admin settings")," documentation."))}ht.isMDXComponent=!0;var gt=function(e){return i.createElement(o.nR,(0,a.Z)({defaultDescription:ht,filepath:"/settings.php",summary:"Plugin settings",examplePurpose:"Plugin settings"},e))},ft=["components"],vt={},kt={toc:[]};function bt(e){var t=e.components,n=(0,l.Z)(e,ft);return(0,r.kt)("wrapper",(0,a.Z)({},kt,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)(s.Z,(0,a.Z)({frontMatter:vt},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,r.kt)("p",null,"Plugins may define a '/styles.css' to provide plugin-specific styling. See the following for further documentation:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://docs.moodle.org/dev/Plugin_contribution_checklist#CSS_styles"},"Plugin contribution checklist#CSS styles")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://docs.moodle.org/dev/CSS_Coding_Style"},"CSS Coding Style"))),(0,r.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Avoid custom styles where possible")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Rather than writing custom CSS for your plugin, where possible apply Bootstrap classes to the DOM elements in your output. These will be easier to maintain and will adopt most colour, branding, and other customisations applied to a theme."))))}bt.isMDXComponent=!0;var yt=function(e){return i.createElement(o.nR,(0,a.Z)({refreshedDuringPurge:!0,defaultDescription:bt,filepath:"/styles.css",summary:"CSS style sheet for your plugin"},e))},Nt=["components"],wt={},xt={toc:[]};function Mt(e){var t=e.components,n=(0,l.Z)(e,Nt);return(0,r.kt)("wrapper",(0,a.Z)({},xt,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)(s.Z,(0,a.Z)({frontMatter:wt},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,r.kt)("p",null,"Details of all third-party libraries should be declared in the ",(0,r.kt)("inlineCode",{parentName:"p"},"thirdpartylibs.xml")," file."),(0,r.kt)("p",null,"This information is used to generate ignore file configuration for linting tools. For Moodle core it is also used to generate library information as part of release notes and credits."),(0,r.kt)("p",null,"Within the XML the ",(0,r.kt)("inlineCode",{parentName:"p"},"location")," is a file, or directory, relative to your plugin's root."),(0,r.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"Licensing")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"The license of any third-party code included in your plugin, and within the ",(0,r.kt)("inlineCode",{parentName:"p"},"thirdpartylibs.xml")," file ",(0,r.kt)("strong",{parentName:"p"},"must")," be ",(0,r.kt)("a",{parentName:"p",href:"http://www.gnu.org/licenses/license-list.html#GPLCompatibleLicenses"},"compatible with the GNU GPLv3"),"."))),(0,r.kt)("p",null,"See the ",(0,r.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Third_Party_Libraries"},"Third Party Libraries")," documentation for further information."))}Mt.isMDXComponent=!0;var _t=function(e){return i.createElement(o.nR,(0,a.Z)({defaultDescription:Mt,defaultExample:'<?xml version="1.0"?>\n<libraries>\n    <library>\n        <location>javascript/html5shiv.js</location>\n        <name>Html5Shiv</name>\n        <version>3.6.2</version>\n        <license>Apache</license>\n        <licenseversion>2.0</licenseversion>\n    </library>\n    <library>\n        <location>vendor/guzzle/guzzle/</location>\n        <name>guzzle</name>\n        <version>v3.9.3</version>\n        <license>MIT</license>\n        <licenseversion></licenseversion>\n    </library>\n</libraries>',filepath:"/thirdpartylibs.xml",filetype:"xml",summary:"Details of third-party libraries includedin the plugin",showLicense:!1,showFileHeader:!1},e))},Tt=["components"],Et={},Ct={toc:[]};function Zt(e){var t=e.components,n=(0,l.Z)(e,Tt);return(0,r.kt)("wrapper",(0,a.Z)({},Ct,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)(s.Z,(0,a.Z)({frontMatter:Et},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,r.kt)("p",null,"Each component and subsystem may make use of an ",(0,r.kt)("inlineCode",{parentName:"p"},"upgrade.txt")," file in the top level folder. A title is used to identify the Moodle version where the change was introduced, and significant changes for that version relating to that component or subsystem are displayed."),(0,r.kt)("p",null,"When changes are integrated to multiple branches, for example a stable version and the master branch, then the relevant versions used to describe the change in the ",(0,r.kt)("inlineCode",{parentName:"p"},"upgrade.txt")," file should be the next version to be released ",(0,r.kt)("em",{parentName:"p"},"for each branch"),". The ",(0,r.kt)("inlineCode",{parentName:"p"},"master")," branch should always use the next major version."),(0,r.kt)("p",null,"For example if a change is applied to the ",(0,r.kt)("strong",{parentName:"p"},"MOODLE_400_STABLE")," during the development of Moodle 4.0.2, and the ",(0,r.kt)("strong",{parentName:"p"},"master")," branch during the development of Moodle 4.1, then the relevant versions will be ",(0,r.kt)("strong",{parentName:"p"},"4.0.2")," and ",(0,r.kt)("strong",{parentName:"p"},"4.1"),"."),(0,r.kt)("p",null,"If a change is only applied to the master branch then only the ",(0,r.kt)("strong",{parentName:"p"},"4.1")," version will be listed."),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"Exception during parallel development")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"When Moodle is developing two major versions in parallel, for example Moodle 3.11.0, and Moodle 4.0.0, then the\nversion in the earliest of the major version development branches will be used for both branches."),(0,r.kt)("p",{parentName:"div"},"For example, during the development of Moodle 3.11, and Moodle 4.0, which took place in parallel, if a change was integrated to 3.11 and 4.0, then the version specified in both branches would be 3.11."))))}Zt.isMDXComponent=!0;var Pt=function(e){return i.createElement(o.nR,(0,a.Z)({recommended:!0,filepath:"/*/upgrade.txt",defaultDescription:Zt,summary:"Significant changes for each version of your plugin"},e))},At=["components"],Dt={},Lt={toc:[]};function It(e){var t=e.components,n=(0,l.Z)(e,At);return(0,r.kt)("wrapper",(0,a.Z)({},Lt,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)(s.Z,(0,a.Z)({frontMatter:Dt},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,r.kt)("p",null,"The version.php contains metadata about the plugin."),(0,r.kt)("p",null,"It is used during the installation and upgrade of the plugin."),(0,r.kt)("p",null,"This file contains metadata used to describe the plugin, and includes information such as:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"the version number"),(0,r.kt)("li",{parentName:"ul"},"a list of dependencies"),(0,r.kt)("li",{parentName:"ul"},"the minimum Moodle version required"),(0,r.kt)("li",{parentName:"ul"},"maturity of the plugin")))}It.isMDXComponent=!0;function Bt(e){return i.createElement(o.nR,(0,a.Z)({required:!0,filepath:"/version.php",filetype:"php",summary:"Version metadata",examplePurpose:"Version metadata",defaultDescription:It,defaultExample:"defined('MOODLE_INTERNAL') || die();\n\n$plugin->version = TODO;\n$plugin->requires = TODO;\n$plugin->supported = TODO;   // Available as of Moodle 3.9.0 or later.\n$plugin->incompatible = TODO;   // Available as of Moodle 3.9.0 or later.\n$plugin->component = 'TODO_FRANKENSTYLE';\n$plugin->maturity = MATURITY_STABLE;\n$plugin->release = 'TODO';\n\n$plugin->dependencies = [\n    'mod_forum' => 2022042100,\n    'mod_data' => 2022042100\n];\n"},e))}var St=["components"],Rt={},$t={toc:[]};function zt(e){var t=e.components,n=(0,l.Z)(e,St);return(0,r.kt)("wrapper",(0,a.Z)({},$t,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)(s.Z,(0,a.Z)({frontMatter:Rt},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,r.kt)("p",null,"In older versions of Moodle, JavaScript was written in the YUI format. This is being phased out in favour of ",(0,r.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Javascript_Modules"},"JavaScript Modules"),", although some older uses still remain in Moodle core."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://docs.moodle.org/dev/YUI/Modules"},"YUI/Modules")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://docs.moodle.org/dev/YUI"},"YUI"))),(0,r.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"New YUI code will not be accepted into Moodle core, except for new plugins for the ",(0,r.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Atto"},"Atto editor"),"."))))}zt.isMDXComponent=!0;var Ht=function(e){return i.createElement(o.nR,(0,a.Z)({legacy:!0,refreshedDuringPurge:!0,defaultDescription:zt,filepath:"/yui/",examplePurpose:"YUI JavaScript Modules",summary:"YUI JavaScript Modules"},e))}},85162:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var a=n(67294),i=n(86010),o="tabItem_Ymn6";function l(e){var t=e.children,n=e.hidden,l=e.className;return a.createElement("div",{role:"tabpanel",className:(0,i.Z)(o,l),hidden:n},t)}},65488:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var a=n(83117),i=n(67294),o=n(86010),l=n(72389),r=n(67392),s=n(7094),p=n(12466),d="tabList__CuJ",c="tabItem_LNqP";function m(e){var t,n,l=e.lazy,m=e.block,u=e.defaultValue,h=e.values,g=e.groupId,f=e.className,v=i.Children.map(e.children,(function(e){if((0,i.isValidElement)(e)&&"value"in e.props)return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})),k=null!=h?h:v.map((function(e){var t=e.props;return{value:t.value,label:t.label,attributes:t.attributes}})),b=(0,r.l)(k,(function(e,t){return e.value===t.value}));if(b.length>0)throw new Error('Docusaurus error: Duplicate values "'+b.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.');var y=null===u?u:null!=(t=null!=u?u:null==(n=v.find((function(e){return e.props.default})))?void 0:n.props.value)?t:v[0].props.value;if(null!==y&&!k.some((function(e){return e.value===y})))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+y+'" but none of its children has the corresponding value. Available values are: '+k.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");var N=(0,s.U)(),w=N.tabGroupChoices,x=N.setTabGroupChoices,M=(0,i.useState)(y),_=M[0],T=M[1],E=[],C=(0,p.o5)().blockElementScrollPositionUntilNextRender;if(null!=g){var Z=w[g];null!=Z&&Z!==_&&k.some((function(e){return e.value===Z}))&&T(Z)}var P=function(e){var t=e.currentTarget,n=E.indexOf(t),a=k[n].value;a!==_&&(C(t),T(a),null!=g&&x(g,String(a)))},A=function(e){var t,n=null;switch(e.key){case"ArrowRight":var a,i=E.indexOf(e.currentTarget)+1;n=null!=(a=E[i])?a:E[0];break;case"ArrowLeft":var o,l=E.indexOf(e.currentTarget)-1;n=null!=(o=E[l])?o:E[E.length-1]}null==(t=n)||t.focus()};return i.createElement("div",{className:(0,o.Z)("tabs-container",d)},i.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,o.Z)("tabs",{"tabs--block":m},f)},k.map((function(e){var t=e.value,n=e.label,l=e.attributes;return i.createElement("li",(0,a.Z)({role:"tab",tabIndex:_===t?0:-1,"aria-selected":_===t,key:t,ref:function(e){return E.push(e)},onKeyDown:A,onFocus:P,onClick:P},l,{className:(0,o.Z)("tabs__item",c,null==l?void 0:l.className,{"tabs__item--active":_===t})}),null!=n?n:t)}))),l?(0,i.cloneElement)(v.filter((function(e){return e.props.value===_}))[0],{className:"margin-top--md"}):i.createElement("div",{className:"margin-top--md"},v.map((function(e,t){return(0,i.cloneElement)(e,{key:t,hidden:e.props.value!==_})}))))}function u(e){var t=(0,l.Z)();return i.createElement(m,(0,a.Z)({key:String(t)},e))}},32798:function(e){e.exports={siteHome:"https://moodle.academy/",courses:{setup:{id:29,name:"Set up your Moodle Development Environment",summary:"Learn about the Moodle developer community and setting up a development environment",description:"This course is designed for PHP developers who want to start developing Moodle plugins. You will learn about the Moodle developer community and set up a Moodle development environment. This is the first course in the Developer Pathway. Subsequent courses in the the Developer Pathway will build on the knowledge gained in this course.",tags:["development","basics","setup"],archived:!1,series:[]},securityEssentials:{id:53,name:"Moodle Access and Security Essentials",summary:"A short course looking at access control and security aspects of plugins.",description:"In this course we look at access control and security aspects of a plugin. Through a set of tutorials, you will learn how to control access to your plugin using Moodle's Access API. You will learn how to define capabilities in your plugin and how to determine if the user has the permission to access a page. This course also covers common security threats that developers need to be aware of.\n\nThis is the fourth course in the Moodle Developer Basics program.",tags:["development","basic","essentials","security","api"],archived:!1,series:["basics"]},outputEssentials:{id:49,name:"Web Output Essentials",summary:"Learn how to use Moodle's Page and Output APIs to display content in a local plugin.",description:"This course builds on the knowledge gained in the Moodle development environment course. In this course, we learn how to use Moodle's Page and Output APIs to display content in a local plugin. An introduction to localisation using language strings is also covered in this course. This is the second course in the Moodle developer pathway.",tags:["development","basics","essentials","output","api"],archived:!1,series:["basics"]},architecture:{id:51,name:"Moodle's Modular Architecture and APIs",summary:"Take a deeper look at Moodle's architecture, exploring common APIs including Navigations, Forms, Database, Upgrade, Strings, and Output.",description:"In this course we take a deeper look at Moodle's modular architecture and explore the use of common Moodle APIs. Some of the APIs covered in this course include: Navigation, Forms, Database access, Upgrade, Strings and Output APIs. Learners get hands-on practise on using these APIs in the form of developing a local plugin.\n\nThis is the third course in the Moodle Developer Basics program.",tags:["development","api","architecture"],archived:!1,series:["basics"]},pluginBasics:{id:10,name:"Moodle Plugin Development Basics",summary:"Learn about the essential concepts in Moodle's moduel architecture.",description:"This course teaches you essential concepts related to Moodle's modular architecture, enabling you to develop a simple demo plugin.\n\nPlease note, this course is being migrated to form a new program of short courses on Moodle Academy (called 'Moodle Developer Basics'), which will all be available at the end of April 2022. For now you may still complete the course on Learn Moodle, or you might like to start the Moodle Academy developer short courses that are being released over the coming weeks and will form this new beginner level program.",tags:["development","basics","essentials","api","plugins","architecture"],archived:!1,series:["basics"]}}}},50793:function(e,t,n){"use strict";n.d(t,{dn:function(){return _.Z},vL:function(){return M},U6:function(){return N},E2:function(){return T.Z},mQ:function(){return E.Z},Zh:function(){return x}});n(86134);var a=n(67294),i=n(87918),o=n(80102),l=n(83117),r=n(95408),s=n(98700),p=n(39707),d=n(59766),c=n(69348),m=n(54502),u=n(85893);const h=["component","direction","spacing","divider","children"];function g(e,t){const n=a.Children.toArray(e).filter(Boolean);return n.reduce(((e,i,o)=>(e.push(i),o<n.length-1&&e.push(a.cloneElement(t,{key:`separator-${o}`})),e)),[])}const f=(0,c.ZP)("div",{name:"MuiStack",slot:"Root",overridesResolver:(e,t)=>[t.root]})((({ownerState:e,theme:t})=>{let n=(0,l.Z)({display:"flex"},(0,r.k9)({theme:t},(0,r.P$)({values:e.direction,breakpoints:t.breakpoints.values}),(e=>({flexDirection:e}))));if(e.spacing){const a=(0,s.hB)(t),i=Object.keys(t.breakpoints.values).reduce(((t,n)=>(null==e.spacing[n]&&null==e.direction[n]||(t[n]=!0),t)),{}),o=(0,r.P$)({values:e.direction,base:i}),l=(0,r.P$)({values:e.spacing,base:i}),p=(t,n)=>{return{"& > :not(style) + :not(style)":{margin:0,[`margin${i=n?o[n]:e.direction,{row:"Left","row-reverse":"Right",column:"Top","column-reverse":"Bottom"}[i]}`]:(0,s.NA)(a,t)}};var i};n=(0,d.Z)(n,(0,r.k9)({theme:t},l,p))}return n})),v=a.forwardRef((function(e,t){const n=(0,m.Z)({props:e,name:"MuiStack"}),a=(0,p.Z)(n),{component:i="div",direction:r="column",spacing:s=0,divider:d,children:c}=a,v=(0,o.Z)(a,h),k={direction:r,spacing:s};return(0,u.jsx)(f,(0,l.Z)({as:i,ownerState:k,ref:t},v,{children:d?g(c,d):c}))}));var k=v,b=n(39960);function y(e,t,n){var o=function(e){return"number"==typeof e&&Number.isInteger(e)?e.toFixed(1):e}(t),l=a.createElement("span",null,function(e){if("since"===e)return"Since";if("deprecated"===e)return"Deprecated";throw new Error("Unknown <Since> type: '"+e+"'")}(e)," ",o),r=a.createElement(i.Z,{key:"chip-"+e+o,label:l,clickable:!!n});return n?a.createElement(b.Z,{to:"https://tracker.moodle.org/browse/"+n,key:"link-"+e+o},r):r}function N(e){var t,n,i,o,l,r,s,p,d,c=(n=(t=e).issueNumber,i=void 0===n?null:n,o=t.type,l=void 0===o?"since":o,r=t.versions,s=void 0===r?[]:r,p=t.version,(d=void 0===p?null:p)?y(l,d,i):s.map((function(e){return y(l,e,i)})));return a.createElement(k,{direction:"row",justifyContent:"flex-end",spacing:2},c)}var w=n(86010);function x(e){return a.createElement("div",{className:(0,w.Z)(" alert alert--success margin-bottom--lg ")},a.createElement("span",{className:(0,w.Z)(" badge badge--success ")},"An example of correct behaviour"),e.children)}function M(e){return a.createElement("div",{className:(0,w.Z)(" alert alert--danger margin-bottom--lg ")},a.createElement("span",{className:(0,w.Z)(" badge badge--danger ")},"An example of incorrect behaviour"),e.children)}n(80069);var _=n(46975),T=n(85162),E=n(65488)},86134:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var a=n(67294),i=n(69119),o=n(39960),l=n(88698),r=n(32798),s=n.n(r),p=n(80684);function d(e){var t=e.courseName;if(!s().courses[t])throw Error("Unknown course "+t);var n=s().courses[t];return a.createElement(i.Z,{type:"info",icon:a.createElement(l.Z,{fontSize:"inherit"}),title:"Learn more on Moodle Academy"},"You can learn more about"," ",a.createElement("strong",null,e.subject)," ","from the"," ",a.createElement(p.Z,{title:n.summary},a.createElement(o.Z,{to:s().siteHome+"course/view.php?id="+n.id},n.name))," ","on Moodle Academy.")}},80069:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var a=n(67294),i=n(87918),o=n(80684),l=n(86886),r=n(34673),s=n(3905),p=function(e,t,n){return void 0===n&&(n="info"),a.createElement(l.ZP,{item:!0,key:e},a.createElement(o.Z,{title:t},a.createElement(i.Z,{label:e,color:n})))};function d(e){var t=e.filepath,n=e.summary,i=function(e){var t=e.required,n=void 0!==t&&t,a=e.legacy,i=void 0!==a&&a,o=e.deprecated,l=void 0!==o&&o,r=e.refreshedDuringUpgrade,s=void 0!==r&&r,d=e.refreshedDuringPurge,c=void 0!==d&&d,m=[];return s&&m.push(p("Upgradable","Changes to this file or directory will be re-applied during a Moodle upgrade. If you make any changes to it, you can simply increment the version number and perform a Moodle upgrade.","info")),c&&m.push(p("Refreshed on cache purge","The contents of this file or directory are cached. To see your changes you can simply purge Moodle's caches and refresh the page.","info")),n&&m.push(p("Required","This file must be present","success")),i&&m.push(p("Legacy","Use of this file is being phased out. It is still supported for older installations but will be removed..","warning")),l&&m.push(p("Deprecated","Use of this file is deprecated and not recommended.It may still be provided for older versions of Moodle but is no longer used.","error")),m}(e),o=e.description?a.createElement(l.ZP,{item:!0,xs:12},e.description):null;return a.createElement(s.Zo,null,a.createElement(l.ZP,{container:!0,spacing:2},a.createElement(l.ZP,{item:!0,xs:6},a.createElement("h4",null,n)),a.createElement(l.ZP,{item:!0,xs:6},a.createElement(l.ZP,{container:!0,spacing:2,justifyContent:"flex-end"},i)),a.createElement(l.ZP,{item:!0,xs:12},a.createElement("h5",null,"File path:"," ",t)),o,function(e){var t=e.example,n=e.open,i=void 0!==n&&n;return t?a.createElement(l.ZP,{item:!0,xs:12},a.createElement(r.Z,{summary:a.createElement("summary",null,"View example"),open:i},t)):null}(e)))}},78989:function(e,t,n){"use strict";n.d(t,{W7:function(){return m}});var a,i=n(67294),o=n(46975),l=JSON.parse('{"plugintypes":{"antivirus":"lib/antivirus","availability":"availability/condition","qtype":"question/type","mod":"mod","auth":"auth","calendartype":"calendar/type","customfield":"customfield/field","enrol":"enrol","message":"message/output","block":"blocks","media":"media/player","filter":"filter","editor":"lib/editor","format":"course/format","dataformat":"dataformat","profilefield":"user/profile/field","report":"report","coursereport":"course/report","gradeexport":"grade/export","gradeimport":"grade/import","gradereport":"grade/report","gradingform":"grade/grading/form","mlbackend":"lib/mlbackend","mnetservice":"mnet/service","webservice":"webservice","repository":"repository","portfolio":"portfolio","search":"search/engine","qbank":"question/bank","qbehaviour":"question/behaviour","qformat":"question/format","plagiarism":"plagiarism","tool":"admin/tool","cachestore":"cache/stores","cachelock":"cache/locks","fileconverter":"files/converter","contenttype":"contentbank/contenttype","theme":"theme","local":"local","h5plib":"h5p/h5plib","paygw":"payment/gateway"},"subsystems":{"access":null,"admin":"admin","adminpresets":"admin/presets","analytics":"analytics","antivirus":"lib/antivirus","auth":"auth","availability":"availability","backup":"backup/util/ui","badges":"badges","block":"blocks","blog":"blog","bulkusers":null,"cache":"cache","calendar":"calendar","cohort":"cohort","comment":"comment","competency":"competency","completion":"completion","contentbank":"contentbank","countries":null,"course":"course","courseformat":"course/format","currencies":null,"customfield":"customfield","dbtransfer":null,"debug":null,"editor":"lib/editor","edufields":null,"enrol":"enrol","error":null,"favourites":"favourites","filepicker":null,"fileconverter":"files/converter","files":"files","filters":"filter","form":"lib/form","grades":"grade","grading":"grade/grading","group":"group","help":null,"hub":null,"h5p":"h5p","imscc":null,"install":null,"iso6392":null,"langconfig":null,"license":null,"mathslib":null,"media":"media","message":"message","mimetypes":null,"mnet":"mnet","my":"my","notes":"notes","pagetype":null,"payment":"payment","pix":null,"plagiarism":"plagiarism","plugin":null,"portfolio":"portfolio","privacy":"privacy","question":"question","rating":"rating","reportbuilder":"reportbuilder","repository":"repository","rss":"rss","role":"admin/roles","search":"search","table":"lib/table","tag":"tag","timezones":null,"user":"user","userkey":"lib/userkey","webservice":"webservice","xapi":"lib/xapi"}}'),r=function(e){return function(t){var n=t.plugintype,a=void 0===n?"plugintype":n,i=t.pluginname,o=void 0===i?"pluginname":i,l=t.filepath,r=void 0===l?null:l,s=function(e){return function(t){return e.plugintypes[t]?e.plugintypes[t]:"[path/to/"+t+"]"}}(e)(a);return""+(s+=o?"/"+o:"/[pluginname]")+r}},s=r(l),p=(s(l),function(e){if(!e.showFileHeader)return"";switch(null==e?void 0:e.filetype){case"xml":return"";case"js":case"javascript":return function(e){var t=e.plugintype,n=void 0===t?"plugintype":t,a=e.pluginname,i=void 0===a?"pluginname":a,o=e.examplePurpose,l=e.modulename;if(!o)throw Error("Purpose must be specified");if(!l)throw Error("AMD Module name must be specified");return["/**"," * "+o+" for the "+n+"_"+i+" plugin."," *"," * @module   "+n+"_"+i+"/"+l," * @copyright Year, You Name <your@email.address>"," * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later"," */",""].join("\n")}(e);default:return function(e){var t=e.plugintype,n=void 0===t?"plugintype":t,a=e.pluginname,i=void 0===a?"pluginname":a,o=e.examplePurpose;if(!o)throw Error("Purpose must be specified");return["/**"," * "+o+" for the "+n+"_"+i+" plugin."," *"," * @package   "+n+"_"+i," * @copyright Year, You Name <your@email.address>"," * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later"," */",""].join("\n")}(e)}}),d=function(e){return e.showLicense?(e.filetype,"// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n"):""},c=function(e){var t=e.filetype,n=void 0===t?"php":t;switch(n){case"js":case"javascript":return"javascript";case"xml":return"xml";case"php":case null:return"php";default:return n}},m=(a=l,function(e,t){var n,l=Object.assign({plugintype:"plugintype",showLicense:!0,showFileHeader:!0,filepath:null!=(n=e.exampleFilepath)?n:e.filepath},e),s=r(a),m=function(e,t){void 0===t&&(t=null);var n=[d(e),p(e),e.example?e.example:t||null].filter((function(e){return e})).map((function(e){return e.trim()})).join("\n\n");return[function(e){var t=e.filetype;switch(void 0===t?"php":t){case"js":case"javascript":case"xml":return null;default:return"<?php"}}(e),n].filter((function(e){return e})).join("\n")}(l,t);return i.createElement(o.Z,{title:s(l),language:c(l)},m)})},34379:function(e,t,n){"use strict";n.r(t),n.d(t,{assets:function(){return h},contentTitle:function(){return m},default:function(){return k},frontMatter:function(){return c},langExample:function(){return g},metadata:function(){return u},toc:function(){return f}});var a=n(83117),i=n(80102),o=(n(67294),n(3905)),l=n(13904),r=n(95757),s=n(60620),p=n(50793),d=["components"],c={title:"Block plugins",tags:["Blocks","Tutorial","Plugins"]},m=void 0,u={unversionedId:"apis/plugintypes/blocks/index",id:"apis/plugintypes/blocks/index",title:"Block plugins",description:"File structure",source:"@site/docs/apis/plugintypes/blocks/index.md",sourceDirName:"apis/plugintypes/blocks",slug:"/apis/plugintypes/blocks/",permalink:"/devdocs/docs/apis/plugintypes/blocks/",draft:!1,editUrl:"https://github.com/moodle/devdocs/edit/main/docs/apis/plugintypes/blocks/index.md",tags:[{label:"Blocks",permalink:"/devdocs/docs/tags/blocks"},{label:"Tutorial",permalink:"/devdocs/docs/tags/tutorial"},{label:"Plugins",permalink:"/devdocs/docs/tags/plugins"}],version:"current",lastUpdatedBy:"Andrew Lyons",lastUpdatedAt:1654666245,formattedLastUpdatedAt:"08/06/2022",frontMatter:{title:"Block plugins",tags:["Blocks","Tutorial","Plugins"]},sidebar:"docs",previous:{title:"Antivirus plugins",permalink:"/devdocs/docs/apis/plugintypes/antivirus/"},next:{title:"Enrolment plugins",permalink:"/devdocs/docs/apis/plugintypes/enrol/"}},h={},g="$string['pluginname'] = 'Pluginname block';\n$string['pluginname'] = 'Pluginname';\n$string['pluginname:addinstance'] = 'Add a new pluginname block';\n$string['pluginname:myaddinstance'] = 'Add a new pluginname block to the My Moodle page';",f=[{value:"File structure",id:"file-structure",level:2},{value:"block_pluginname.php",id:"block_pluginnamephp",level:3},{value:"db/access.php",id:"dbaccessphp",level:3},{value:"lang/en/block_pluginname.php",id:"langenblock_pluginnamephp",level:3},{value:"version.php",id:"versionphp",level:3},{value:"edit_form.php",id:"edit_formphp",level:3},{value:"Creating a new block plugin",id:"creating-a-new-block-plugin",level:2},{value:"Block base class API methods",id:"block-base-class-api-methods",level:2},{value:"Block class attributes",id:"block-class-attributes",level:3},{value:"init()",id:"init",level:3},{value:"specialization()",id:"specialization",level:3},{value:"get_content(): string",id:"get_content-string",level:3},{value:"applicable_formats(): array",id:"applicable_formats-array",level:3},{value:"instance_allow_multiple()",id:"instance_allow_multiple",level:3},{value:"hide_header(): bool",id:"hide_header-bool",level:3},{value:"html_attributes(): array",id:"html_attributes-array",level:3},{value:"instance_config_save(): stdClass",id:"instance_config_save-stdclass",level:3},{value:"has_config(): bool",id:"has_config-bool",level:3},{value:"Add instance configuration settings",id:"add-instance-configuration-settings",level:2},{value:"Create a edit_form.php file",id:"create-a-edit_formphp-file",level:3},{value:"Optional instance_config_save method",id:"optional-instance_config_save-method",level:3},{value:"Add global settings to the block plugin",id:"add-global-settings-to-the-block-plugin",level:2},{value:"create a settings.php file",id:"create-a-settingsphp-file",level:3},{value:"Enabling Global Configuration",id:"enabling-global-configuration",level:3},{value:"Limit the block to specific contexts",id:"limit-the-block-to-specific-contexts",level:2}],v={langExample:g,toc:f};function k(e){var t=e.components,n=(0,i.Z)(e,d);return(0,o.kt)("wrapper",(0,a.Z)({},v,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)(l.Z,(0,a.Z)({frontMatter:c},void 0!==u?{metadata:u}:{},{mdxType:"MoodlePageBanner"})),(0,o.kt)("h2",{id:"file-structure"},"File structure"),(0,o.kt)("p",null,"Blocks plugins are located in the ",(0,o.kt)("inlineCode",{parentName:"p"},"/blocks")," directory."),(0,o.kt)("p",null,"Each plugin is in a separate subdirectory and consists of a number of ",(0,o.kt)("em",{parentName:"p"},"mandatory files")," and any other files the developer is going to use."),(0,o.kt)("details",null,(0,o.kt)("summary",null,"View an example directory layout for the `block_pluginname` plugin."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-console"}," blocks/pluginname/\n |-- db\n |   `-- access.php\n |-- lang\n |   `-- en\n |       `-- block_pluginname.php\n |-- pix\n |   `-- icon.png\n |-- block_pluginname.php\n |-- edit_form.php (optional)\n `-- version.php\n"))),(0,o.kt)("h3",{id:"block_pluginnamephp"},"block_pluginname.php"),(0,o.kt)(s.nR,{required:!0,filepath:"/block_pluginname.php",summary:"Block definition class",plugintype:"block",pluginname:"pluginname",example:"class block_pluginname extends block_base {\n\n    /**\n     * Initialises the block.\n     *\n     * @return void\n     */\n    public function init() {\n        $this->title = get_string('pluginname', 'block_pluginname');\n    }\n\n    /**\n     * Gets the block contents.\n     *\n     * @return string The block HTML.\n     */\n    public function get_content() {\n        global $OUTPUT;\n\n        if ($this->content !== null) {\n            return $this->content;\n        }\n\n        $this->content = new stdClass();\n        $this->content->footer = '';\n\n        // Add logic here to define your template data or any other content.\n        $data = ['YOUR DATA GOES HERE'];\n\n        $this->content->text = $OUTPUT->render_from_template('block_yourplugin/content', $data);\n\n        return $this->content;\n    }\n\n    /**\n     * Defines in which pages this block can be added.\n     *\n     * @return array of the pages where the block can be added.\n     */\n    public function applicable_formats() {\n        return [\n            'admin' => false,\n            'site-index' => true,\n            'course-view' => true,\n            'mod' => false,\n            'my' => true,\n        ];\n    }\n}\n",description:"This file will hold the class definition for the block, and is used both to manage it as a plugin and to render it onscreen.",mdxType:"ComponentFileSummary"}),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"The ",(0,o.kt)("inlineCode",{parentName:"p"},"init")," method is essential for all blocks, and its purpose is to give values to any class member variables that need instantiating."))),(0,o.kt)("h3",{id:"dbaccessphp"},"db/access.php"),(0,o.kt)(r.MC,{plugintype:"block",pluginname:"pluginname",example:"$capabilities = [\n    'block/pluginname:myaddinstance' => [\n        'captype' => 'write',\n        'contextlevel' => CONTEXT_SYSTEM,\n        'archetypes' => [\n            'user' => CAP_ALLOW\n        ],\n        'clonepermissionsfrom' => 'moodle/my:manageblocks'\n    ],\n    'block/pluginname:addinstance' => [\n        'riskbitmask' => RISK_SPAM | RISK_XSS,\n        'captype' => 'write',\n        'contextlevel' => CONTEXT_BLOCK,\n        'archetypes' => [\n            'editingteacher' => CAP_ALLOW,\n            'manager' => CAP_ALLOW\n        ],\n        'clonepermissionsfrom' => 'moodle/site:manageblocks'\n    ],\n];\n",required:!0,mdxType:"DbAccessPHP"}),(0,o.kt)("h3",{id:"langenblock_pluginnamephp"},"lang/en/block_pluginname.php"),(0,o.kt)(r.Uo,{plugintype:"block",pluginname:"pluginname",example:g,mdxType:"Lang"}),(0,o.kt)("h3",{id:"versionphp"},"version.php"),(0,o.kt)(r.f_,{plugintype:"block",mdxType:"VersionPHP"}),(0,o.kt)("h3",{id:"edit_formphp"},"edit_form.php"),(0,o.kt)(s.nR,{filepath:"/edit_form.php",summary:"Block edit form class",plugintype:"block",pluginname:"pluginname",example:"class block_pluginname_edit_form extends block_edit_form {\n    protected function specific_definition($mform) {\n        // Section header title according to language file.\n        $mform->addElement('header', 'config_header', get_string('blocksettings', 'block'));\n        // A sample string variable with a default value.\n        $mform->addElement('text', 'config_text', get_string('blockstring', 'block_pluginname'));\n        $mform->setDefault('config_text', 'default value');\n        $mform->setType('config_text', PARAM_TEXT);\n    }\n}\n",description:"This file is only needed if yourt plugin have a specific configuration form. It is not required for most plugins. We can extend this configuration form, and add custom preferences fields, so that users can better tailor our block to a given task or page.",mdxType:"ComponentFileSummary"}),(0,o.kt)("p",null,"The example below adds a text attribute to the block instance settings."),(0,o.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"All your field names need to start with ",(0,o.kt)("strong",{parentName:"p"},'"config_"'),", otherwise they will not be saved and will not be available within the block via $this->config."))),(0,o.kt)("h2",{id:"creating-a-new-block-plugin"},"Creating a new block plugin"),(0,o.kt)("p",null,"The easiest way to create a new block plugin is by using the latest version of ",(0,o.kt)("a",{parentName:"p",href:"https://moodle.org/plugins/tool_pluginskel"},"Tool Pluginskel"),". You can use the following yaml file to generate a basic block skeleton."),(0,o.kt)("details",null,(0,o.kt)("summary",null,"View pluginskel recipe"),(0,o.kt)("div",null,(0,o.kt)(p.dn,{language:"yaml",mdxType:"CodeBlock"},'## This is an example recipe file that you can use as a template for your own plugins.\n## See the list of all files it would generate:\n##\n##     php generate.php example.yaml --list-files\n##\n## View a particular file contents without actually writing it to the disk:\n##\n##     php generate.php example.yaml --file=version.php\n##\n## To see the full list of options, run:\n##\n##     php generate.php --help\n##\n---\n## Frankenstyle component name.\ncomponent: block_pluginname\n\n## Human readable name of the plugin.\nname: Example block\n\n## Human readable release number.\nrelease: "0.1.0"\n\n## Plugin version number, e.g. 2016062100. Will be set to current date if left empty.\n#version: 2016121200\n\n## Required Moodle version, e.g. 2015051100 or "2.9".\nrequires: "3.11"\n\n## Plugin maturity level. Possible options are MATURIY_ALPHA, MATURITY_BETA,\n## MATURITY_RC or MATURIY_STABLE.\nmaturity: MATURITY_BETA\n\n## Copyright holder(s) of the generated files and classes.\ncopyright: Year, You Name <your@email.address>\n\n## Features flags can control generation of optional files/code fragments.\nfeatures:\n  readme: true\n  license: true\n\n  ## Privacy API implementation\nprivacy:\n  haspersonaldata: false\n  uselegacypolyfill: false\n\nblock_features:\n  ## Creates the file edit_form.php\n  edit_form: true\n\n  ## Allows multiple instances of the block on the same course.\n  instance_allow_multiple: false\n\n  ## Choose where to display the block.\n  applicable_formats:\n    - page: all\n      allowed: false\n    - page: course-view\n      allowed: true\n    - page: course-view-social\n      allowed: false\n\n  ## Backup the block plugin.\n  backup_moodle2:\n    restore_task: true\n    restore_stepslib: true\n    backup_stepslib: true\n    settingslib: true\n    backup_elements:\n      - name: elt\n    restore_elements:\n      - name: elt\n        path: /path/to/file\n\n## Capabilities defined by the plugin.\ncapabilities:\n  ## Required by block plugins.\n  - name: myaddinstance\n    title: Add a new pluginname block to the My dashboard\n    captype: write\n    contextlevel: CONTEXT_SYSTEM\n    archetypes:\n      - role: user\n        permission: CAP_ALLOW\n    clonepermissionsfrom: moodle/my:manageblocks\n\n  - name: addinstance\n    title: Add a new pluginname block\n    captype: write\n    contextlevel: CONTEXT_BLOCK\n    archetypes:\n      - role: editingteacher\n        permission: CAP_ALLOW\n      - role: manager\n        permission: CAP_ALLOW\n    clonepermissionsfrom: moodle/site:manageblocks\n\n## Explicitly added strings\nlang_strings:\n  - id: mycustomstring\n    text: You can add \'extra\' strings via the recipe file.\n  - id: mycustomstring2\n    text: Another string with {$a->some} placeholder.\n'))),(0,o.kt)("h2",{id:"block-base-class-api-methods"},"Block base class API methods"),(0,o.kt)("p",null,"All blocks must provide a main class that extends the core block class. However, there are two different types of blocks:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"block_base")," - The default base class for content blocks."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"block_list")," - For blocks that displays a list items.")),(0,o.kt)("p",null,"Depending on your plugin needs your main class in ",(0,o.kt)("inlineCode",{parentName:"p"},"blocks/pluginname/block_pluginname.php")," must extend either ",(0,o.kt)("inlineCode",{parentName:"p"},"block_base")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"block_list"),"."),(0,o.kt)("h3",{id:"block-class-attributes"},"Block class attributes"),(0,o.kt)("p",null,"Once the block instance is created, there are several $this attributes that can be used:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"$this->config")," The block instance configuration. By default it is an empty object but if the block has a ",(0,o.kt)("a",{parentName:"li",href:"#edit_form.php"},"edit_form.php")," file, it will be an object with the form data."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"$this->content")," This variable holds all the actual content that is displayed inside each block. Valid values for it are either NULL or an object of class stdClass, which must have specific member variables depending on the extended block base class."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"$this->page")," The page object that the block is being displayed on."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"$this->context")," The context object that the block is being displayed in."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"$this->title")," The title of the block.")),(0,o.kt)("h3",{id:"init"},"init()"),(0,o.kt)("p",null,"The init method is called before the block is displayed. It is essential for all blocks, and its purpose is to give values to any class member variables that need instantiating. However, it is called before $this->config is set, if your plugin needs some configation value to define global attributes like the block title, it should be done in the specialization method."),(0,o.kt)("h3",{id:"specialization"},"specialization()"),(0,o.kt)("p",null,"This function is called on your subclass right after an instance is loaded. It is used to customize the title and other block attributes depending on the page type, context, configuration, etc."),(0,o.kt)("details",null,(0,o.kt)("summary",null,"View example"),(0,o.kt)("div",null,(0,o.kt)("p",null,"Example of a specialization method using the instance configuration."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-php"},"function specialization() {\n    if (isset($this->config->title)) {\n        $this->title = format_string($this->config->title, true, ['context' => $this->context]);\n    } else {\n        $this->title = get_string('newhtmlblock', 'block_html');\n    }\n}\n")))),(0,o.kt)("h3",{id:"get_content-string"},"get_content(): string"),(0,o.kt)("p",null,"In order to get our block to actually display something on screen, we need to add one more method to our class (before the final closing brace in our file) inside of the block_pluginname.php script."),(0,o.kt)(p.mQ,{mdxType:"Tabs"},(0,o.kt)(p.E2,{value:"basecontent",label:"block_base block",default:!0,mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-php"},"class block_pluginname extends block_base {\n\n    // (...)\n\n    public function get_content() {\n        if ($this->content !== null) {\n            return $this->content;\n        }\n\n        $this->content =  new stdClass;\n        $this->content->text = 'The content of pluginname block';\n        $this->content->footer = 'Footer here...';\n\n        return $this->content;\n    }\n}\n"))),(0,o.kt)(p.E2,{value:"listcontent",label:"block_list block",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-php"},"class block_pluginname extends block_list {\n\n    // (...)\n\n    public function get_content() {\n        global $OUTPUT;\n        if ($this->content !== null) {\n            return $this->content;\n        }\n\n        $this->content = (object) [\n            'items'  => [],\n            'icons'  => [],\n            'footer' => 'Footer here...',\n        ];\n\n        $this->content->items[] = 'An item of pluginname block';\n        $this->content->icons[] = $OUTPUT->pix_icon('i/course', get_string('course'));\n\n        // Add more list items here.\n\n        return $this->content;\n    }\n}\n")))),(0,o.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"The get_content can be called several times during the page rendering. To prevent your class from calculating it every time your plugin should check if $this->content is already defined at the beginning of the method."))),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"If the block content is empty (an empty string) the block will not be displayed. In the case of an extending block_base block this means empty the ",(0,o.kt)("inlineCode",{parentName:"p"},"$this->content->text")," and the ",(0,o.kt)("inlineCode",{parentName:"p"},"$this->content->footer")," values. In a block_list block, the ",(0,o.kt)("inlineCode",{parentName:"p"},"$this->content->items")," array should be empty. Moodle performs this check by calling the block's ",(0,o.kt)("inlineCode",{parentName:"p"},"is_empty()")," method, and if the block is indeed empty then it is not displayed at all."))),(0,o.kt)("h3",{id:"applicable_formats-array"},"applicable_formats(): array"),(0,o.kt)("p",null,"Blocks can be added to any kind of page. However, some blocks may only be displayed on certain page types. This method is used to define the page types that the block can be displayed on. See ",(0,o.kt)("a",{parentName:"p",href:"#limit-the-block-to-specific-contexts"},"Limit the block to specific contexts")," section below for more information."),(0,o.kt)("h3",{id:"instance_allow_multiple"},"instance_allow_multiple()"),(0,o.kt)("p",null,"By default, only one instance of each block plugin can be added to a page. However, if your plugin allows multiple instances you can overrdie the instance_allow_multiple method."),(0,o.kt)("details",null,(0,o.kt)("summary",null,"View example"),(0,o.kt)("div",null,(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-php"},"public function instance_allow_multiple() {\n    return true;\n}\n")))),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Even if a block itself allows multiple instances in the same page, the administrator still has the option of disallowing such behavior. This setting can be set separately for each block from the Administration / Configuration / Blocks page."))),(0,o.kt)("h3",{id:"hide_header-bool"},"hide_header(): bool"),(0,o.kt)("p",null,"Using this method each block instance can decide if the standard block header is shown or not. This method will be ignored in edit mode."),(0,o.kt)("details",null,(0,o.kt)("summary",null,"View example"),(0,o.kt)("div",null,(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-php"},"public function hide_header() {\n    return true;\n}\n")))),(0,o.kt)("h3",{id:"html_attributes-array"},"html_attributes(): array"),(0,o.kt)("p",null,"The block base class can inject extra HTML attributes to the block wrapper. This is useful for example to add a class to the block wrapper when the block is being displayed in a specific context."),(0,o.kt)("p",null,"By default, each block section in the page will use a standard ",(0,o.kt)("inlineCode",{parentName:"p"},"block")," class and the specific ",(0,o.kt)("inlineCode",{parentName:"p"},"block_pluginname")," class. However, if you want to add a class to the block wrapper, you can override html_attributes to alter those attrributes."),(0,o.kt)("details",null,(0,o.kt)("summary",null,"View example"),(0,o.kt)("div",null,(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-php"},"public function html_attributes() {\n    // Get default values.\n    $attributes = parent::html_attributes();\n    // Append our class to class attribute.\n    $attributes['class'] .= ' block_'. $this->name();\n    return $attributes;\n}\n")))),(0,o.kt)("p",null,'This results in the block having all its normal HTML attributes, as inherited from the base block class, plus our additional class name. We can now use this class name to change the style of the block, add JavaScript events to it via YUI, and so on. And for one final elegant touch,  we have not set the class to the hard-coded value "block_simplehtml", but instead used the Blocks/Appendix_A#name.28.29| name() method to make it dynamically match our block\'s name.'),(0,o.kt)("h3",{id:"instance_config_save-stdclass"},"instance_config_save(): stdClass"),(0,o.kt)("p",null,"An optional method to modify the instance configuration before it is saved. See ",(0,o.kt)("a",{parentName:"p",href:"#add-instance-configuration-settings"},"add instance configuration settings")," section below for more information."),(0,o.kt)("h3",{id:"has_config-bool"},"has_config(): bool"),(0,o.kt)("p",null,"An optional method to tell Moodle that the block has a global configuration settings form. See ",(0,o.kt)("a",{parentName:"p",href:"#enabling-global-configuration"},"enabling Global Configuration")," section below for more information."),(0,o.kt)("h2",{id:"add-instance-configuration-settings"},"Add instance configuration settings"),(0,o.kt)("p",null,"By default, block instances have no configuration settings. If you want to add some, you can add them by adsding a few methods and classes to your block."),(0,o.kt)("h3",{id:"create-a-edit_formphp-file"},"Create a edit_form.php file"),(0,o.kt)("p",null,"To have a configuration form, you need to add a ",(0,o.kt)("a",{parentName:"p",href:"#edit_formphp"},"edit_form.php")," file into your plugin. After defining the configuration your blck base instance will have all your settings into ",(0,o.kt)("a",{parentName:"p",href:"#block-class-attributes"},"$this->config attribute"),". See the ",(0,o.kt)("a",{parentName:"p",href:"#edit_formphp"},"edit_form.php section above")," for an example."),(0,o.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Note that $this->config is available in all block methods ",(0,o.kt)("strong",{parentName:"p"},"except the init() one"),". This is because init() is called immediately as the block is being created, with the purpose of setting things up. Use ",(0,o.kt)("a",{parentName:"p",href:"#specialization"},"specialization")," intead."))),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"You cannot use the 'checkbox' element in the form (once set it will stay set). You must use advcheckbox instead."))),(0,o.kt)("h3",{id:"optional-instance_config_save-method"},"Optional instance_config_save method"),(0,o.kt)("p",null,"By default, all config_* settings will be stored in the ",(0,o.kt)("inlineCode",{parentName:"p"},"block_instance")," table. The complete form data will be encoded in base64 before storing it in the "," ",(0,o.kt)("inlineCode",{parentName:"p"},"configdata")," "," field. Every time a block instance is initialized all that data will be decoded in the ",(0,o.kt)("a",{parentName:"p",href:"#block-class-attributes"},"$this->config attribute"),"."),(0,o.kt)("p",null,"However, for some cases like the Atto HTML editor, you may want to store them in the database instead, or to alter the config data before storing it. In that case you can create a instance_config_save method."),(0,o.kt)("details",null,(0,o.kt)("summary",null,"View example"),(0,o.kt)("div",null,(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-php",metastring:'title="Example of adding data before storing it',title:'"Example',of:!0,adding:!0,data:!0,before:!0,storing:!0,it:!0},"public function instance_config_save($data,$nolongerused =false) {\n    // Example of add new data.\n    $data->somenewattribute = 'Some new value';\n\n    // Example of alter the current data.\n    $data->text = 'Some new text';\n\n    // Call the parent method to the data inside block_instance.configdata.\n    return parent::instance_config_save($data,$nolongerused);\n}\n")))),(0,o.kt)("h2",{id:"add-global-settings-to-the-block-plugin"},"Add global settings to the block plugin"),(0,o.kt)("p",null,"Apart from the specific block instance configuration, the block plugin can use global settings to customize its behavior. Those settings can only be set in the site administration and are a great way to customize the behavior of all blocks on a site."),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Global settings are not part of hte block instance and should be accessed via the global get_config method. For example:"),(0,o.kt)("pre",{parentName:"div"},(0,o.kt)("code",{parentName:"pre",className:"language-php"},"$settingvalue = get_config('block_pluginname', 'settingname');\n")))),(0,o.kt)("h3",{id:"create-a-settingsphp-file"},"create a settings.php file"),(0,o.kt)("p",null,"Implementing such configuration for our block is quite similar to implementing the ",(0,o.kt)("a",{parentName:"p",href:"#add-instance-configuration-settings"},"instance configuration"),". To enable global configuration for the block, your plugin should contain ",(0,o.kt)("strong",{parentName:"p"},"/blocks/simplehtml/settings.php")," file. This file will populate the global admin form with form field definitions for each setting. See ",(0,o.kt)("a",{parentName:"p",href:"../commonfiles#settingsphp"},"Common files: settings.php")," for more information."),(0,o.kt)("h3",{id:"enabling-global-configuration"},"Enabling Global Configuration"),(0,o.kt)("p",null,"While in other Moodle pulgins the existence of a settings.php is enough to enable global configuration, for the blocks plugins it is mandatory to override the has_config method in the base class."),(0,o.kt)("details",null,(0,o.kt)("summary",null,"View example"),(0,o.kt)("div",null,(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:'language-php"'},"function has_config() {\n    return true;\n}\n")))),(0,o.kt)("h2",{id:"limit-the-block-to-specific-contexts"},"Limit the block to specific contexts"),(0,o.kt)("p",null,'Some blocks are useful in some circumstances, but not in others. An example of this would be the "Social Activities" block, which is useful in courses with the "social" course format, but not courses with the "weeks" format. Moodle allows us to declare in which pages a block is available on. The information is given to Moodle as a standard associative array, with each key corresponding to a page format and defining a boolean value (true/false) that declares whether the block should be allowed to appear in that page format.'),(0,o.kt)("p",null,"Each page in Moodle can define it's own page type name. However, there are some conventions:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"all")," value is used as a catch-all option. This means that if a block returns ",(0,o.kt)("inlineCode",{parentName:"li"},"['all' => true]")," it can be used in any kind of page."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"site-index")," - Moodle frontpage."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"course-view")," - Course page, independent from the course format."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"course-view-FORMATNAME"),' - Course page, with the "FORMATNAME" course format. For example, course-view-weeks is for courses with weeks format.'),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"mod")," - Any activity page, independent from the module."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"mod-MODNAME-view"),' - Activity page, with the "MODNAME" activity. For example, mod-forum-view is for forums.'),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"my")," - The Moodle dashboard page."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"admin")," - Any administration page.")),(0,o.kt)("details",null,(0,o.kt)("summary",null,"View example"),(0,o.kt)("div",null,(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-php"},"public function applicable_formats() {\n    return [\n        'admin' => false,\n        'site-index' => false,\n        'course-view' => true,\n        'mod' => true,\n        'my' => false\n    ];\n}\n")))))}k.isMDXComponent=!0}}]);
"use strict";(self.webpackChunkdevdocs=self.webpackChunkdevdocs||[]).push([[15489],{60620:function(e,t,n){n.d(t,{nR:function(){return s}});var a=n(67294),i=n(80069),o=n(3905),r=n(78989),l=function(e){return"boolean"!=typeof e&&e?"string"==typeof e||a.isValidElement(e)?a.createElement(o.Zo,null,e):a.createElement(o.Zo,null,a.createElement(e,null)):null},s=function(e){var t,n,s,d=function(e){return Object.assign({filetype:"php",examplePurpose:e.summary},e)}(Object.assign({examplePurpose:null!=(t=null==e?void 0:e.summary)?t:null},e));(d.description=function(e,t){var n=e.description,i=void 0===n?null:n,r=e.extraDescription,s=void 0===r?null:r,d=e.children,p=void 0===d?null:d;if(p){var m=l(p);return a.createElement(o.Zo,null,m)}if(i){var c=l(i);return a.createElement(o.Zo,null,c)}var u=l(t),h=l(s);return u?a.createElement(o.Zo,null,u,h):null}(d,null!=(n=null==d?void 0:d.defaultDescription)?n:null),null!=d&&d.example||null!=d&&d.defaultExample)&&(d.example=(0,r.W7)(d,null!=(s=null==d?void 0:d.defaultExample)?s:null));return(0,i.Z)(d)}},95757:function(e,t,n){n.d(t,{D5:function(){return u},dk:function(){return k},i9:function(){return M},Jk:function(){return D},Id:function(){return A},MC:function(){return S},tw:function(){return O},_n:function(){return j},c5:function(){return Q},Hg:function(){return ie},BO:function(){return de},L5:function(){return he},oI:function(){return ye},sY:function(){return xe},T5:function(){return Ee},ss:function(){return Ie},Uo:function(){return $e},Gf:function(){return Fe},KQ:function(){return Ve},Y1:function(){return et},J$:function(){return ot},t5:function(){return pt},Wy:function(){return ft},dU:function(){return Nt},NA:function(){return _t},ZA:function(){return Pt},f_:function(){return Rt},My:function(){return zt}});var a=n(83117),i=n(67294),o=n(60620),r=n(80102),l=n(3905),s=n(13904),d=["components"],p={},m={toc:[]};function c(e){var t=e.components,n=(0,r.Z)(e,d);return(0,l.kt)("wrapper",(0,a.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)(s.Z,(0,a.Z)({frontMatter:p},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,l.kt)("p",null,"JavaScript in Moodle is written in the ESM format, and transpiled into AMD modules for deployment."),(0,l.kt)("p",null,"The ",(0,l.kt)("a",{parentName:"p",href:"../guides/javascript"},"Moodle JavaScript Guide")," has detailed information and examples on writing JavaScript in Moodle. Further information is also available in the ",(0,l.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Javascript_Modules"},"Javascript Modules")," documentation."),(0,l.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"Although the AMD module format is supported, all new JavaScript is written in the EcmaScript Module (ESM) format."))))}c.isMDXComponent=!0;var u=function(e){return i.createElement(o.nR,(0,a.Z)({required:!0,defaultDescription:c,defaultExample:"\nimport {fetchThings} from './repository';\n\nexport const updateThings = (thingData) => {\n    return fetchThings(thingData);\n};\n",examplePurpose:"Example module",filepath:"/amd/src/example.js",filetype:"js",modulename:"example",summary:"AMD JavaScript Modules"},e))},h=["components"],f={},g={toc:[]};function v(e){var t=e.components,n=(0,r.Z)(e,h);return(0,l.kt)("wrapper",(0,a.Z)({},g,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)(s.Z,(0,a.Z)({frontMatter:f},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,l.kt)("p",null,"If your plugin stores data then you may need to implement the Backup feature which allows the activity to backed up, restored, and duplicated."),(0,l.kt)("p",null,"For more information on Backup and restore, see the following:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://docs.moodle.org/dev/Backup_2.0_for_developers"},"Backup 2.0 for developers")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://docs.moodle.org/dev/Restore_2.0_for_developers"},"Restore 2.0 for developers"))))}v.isMDXComponent=!0;var k=function(e){return i.createElement(o.nR,(0,a.Z)({filepath:"/backup/",summary:"Plugin Backup configuration",defaultDescription:v},e))},y=["components"],N={},b={toc:[]};function w(e){var t=e.components,n=(0,r.Z)(e,y);return(0,l.kt)("wrapper",(0,a.Z)({},b,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)(s.Z,(0,a.Z)({frontMatter:N},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,l.kt)("p",null,"For plugins which make use of ",(0,l.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/CLI_scripts"},"CLI scripts"),", the convention is that these are placed into the ",(0,l.kt)("inlineCode",{parentName:"p"},"cli")," folder to make their purpose clear, and easy to find."),(0,l.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"All CLI scripts ",(0,l.kt)("strong",{parentName:"p"},"must")," declare themselves as being a CLI script by defining the ",(0,l.kt)("inlineCode",{parentName:"p"},"CLI_SCRIPT")," constant to true before including ",(0,l.kt)("inlineCode",{parentName:"p"},"config.php"),"."))))}w.isMDXComponent=!0;var M=function(e){return i.createElement(o.nR,(0,a.Z)({filepath:"/cli/",summary:"CLI scripts",exampleFilepath:"/cli/example.php",examplePurpose:"Example CLI script",defaultDescription:w,defaultExample:"define('CLI_SCRIPT', true);\n\nrequire_once(__DIR__ . '/../../config.php');\nrequire_once(\"{$CFG->libdir}/clilib.php\");\n\n// Your CLI features go here.\n"},e))},x=["components"],_={},T={toc:[]};function C(e){var t=e.components,n=(0,r.Z)(e,x);return(0,l.kt)("wrapper",(0,a.Z)({},T,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)(s.Z,(0,a.Z)({frontMatter:_},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,l.kt)("p",null,"If your plugin includes a changelog in its root directory, this will be used to automatically pre-fill the release notes field when uploading new versions of your plugin to the ",(0,l.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Plugins_directory"},"Plugins directory"),". This file can be in any of the following locations:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"CHANGES.md"),": as a markdown file; or"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"CHANGES.txt"),": as a text file; or"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"CHANGES.html"),": as an HTML file; or"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"CHANGES"),": as a text file.")))}C.isMDXComponent=!0;var D=function(e){return i.createElement(o.nR,(0,a.Z)({filepath:"/CHANGES",filetype:"php",summary:"Plugin changelog",recommended:!0,defaultDescription:C},e))},E=["components"],P={},Z={toc:[]};function L(e){var t=e.components,n=(0,r.Z)(e,E);return(0,l.kt)("wrapper",(0,a.Z)({},Z,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)(s.Z,(0,a.Z)({frontMatter:P},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,l.kt)("p",null,"Moodle supports, and recommends, the use of autoloaded PHP classes."),(0,l.kt)("p",null,"By placing files within the ",(0,l.kt)("inlineCode",{parentName:"p"},"classes")," directory or appropriate sub-directories, and with the correct PHP Namespace, and class name, Moodle is able to autoload classes without the need to manually require, or include them."),(0,l.kt)("p",null,"Details on these rules and conventions are available in the following documentation:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"/general/development/policies/codingstyle#namespaces"},"Coding style - namespace conventions")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://docs.moodle.org/dev/Automatic_class_loading"},"Automatic class loading"))))}L.isMDXComponent=!0;var A=function(e){return i.createElement(o.nR,(0,a.Z)({filepath:"/classes/",summary:"Autoloaded classes",defaultDescription:L},e))},I=["components"],R={},B={toc:[]};function X(e){var t=e.components,n=(0,r.Z)(e,I);return(0,l.kt)("wrapper",(0,a.Z)({},B,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)(s.Z,(0,a.Z)({frontMatter:R},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"db/access.php")," file contains the ",(0,l.kt)("strong",{parentName:"p"},"initial")," configuration for a plugin's access control rules."),(0,l.kt)("p",null,"Access control is handled in Moodle by the use of Roles, and Capabilities. You can read more about these in the ",(0,l.kt)("a",{parentName:"p",href:"/devdocs/docs/apis/subsystems/access"},"Access API")," documentation."),(0,l.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"Changing initial configuration")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"If you make changes to the initial configuration of ",(0,l.kt)("em",{parentName:"p"},"existing")," access control rules, these will only take effect for ",(0,l.kt)("em",{parentName:"p"},"new installations of your plugin"),". Any existing installation ",(0,l.kt)("strong",{parentName:"p"},"will not")," be updated with the latest configuration."),(0,l.kt)("p",{parentName:"div"},"Updating existing capability configuration for an installed site is not recommended as it may have already been modified by an administrator."))))}X.isMDXComponent=!0;var S=function(e){return i.createElement(o.nR,(0,a.Z)({defaultDescription:X,defaultExample:"$capabilities = [\n    // Ability to use the plugin.\n    'plugintype/pluginname:useplugininstance' => [\n        'riskbitmask' => RISK_XSS,\n        'captype' => 'write',\n        'contextlevel' => CONTEXT_COURSE,\n        'archetypes' => [\n            'manager' => CAP_ALLOW,\n            'editingteacher' => CAP_ALLOW,\n        ],\n    ],\n];\n",filepath:"/db/access.php",summary:"Plugin capabilities",examplePurpose:"Plugin capabilities"},e))},$=["components"],z={},H={toc:[]};function U(e){var t=e.components,n=(0,r.Z)(e,$);return(0,l.kt)("wrapper",(0,a.Z)({},H,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)(s.Z,(0,a.Z)({frontMatter:z},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,l.kt)("p",null,"Moodle supports a feature known as ",(0,l.kt)("em",{parentName:"p"}," ",(0,l.kt)("a",{parentName:"em",href:"https://docs.moodle.org/dev/Events_API#Event_observers"},"Event observers")," ")," to allow components to make changes when certain events take place."),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"db/events.php")," file allows you define any event subscriptions that your plugin needs to listen for."),(0,l.kt)("p",null,"Event subscriptions are a convenient way to observe events generated elsewhere in Moodle."),(0,l.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"Communication between components")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"You ",(0,l.kt)("em",{parentName:"p"},"should not")," use event subscriptions to subscribe to events belonging to other plugins, without defining a dependency upon that plugin."),(0,l.kt)("p",{parentName:"div"},"See the ",(0,l.kt)("a",{parentName:"p",href:"/general/development/policies/component-communication#event-observers"},"Component communication principles")," documentation for a description of some of the risks of doing so."))))}U.isMDXComponent=!0;var O=function(e){return i.createElement(o.nR,(0,a.Z)({refreshedDuringUpgrade:!0,defaultDescription:U,defaultExample:"$observers = [\n    [\n        'eventname' => '\\core\\event\\course_module_created',\n        'callback'  => '\\plugintype_pluginname\\event\\observer\\course_module_created::store',\n        'priority'  => 1000,\n    ],\n];\n",filepath:"/db/events.php",summary:"Event observer definitions",examplePurpose:"Event observer definitions"},e))},F=["components"],q={},G={toc:[]};function W(e){var t=e.components,n=(0,r.Z)(e,F);return(0,l.kt)("wrapper",(0,a.Z)({},G,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)(s.Z,(0,a.Z)({frontMatter:q},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"db/install.php")," file allows you define a post-installation hook, which is called immediately after the initial creation of your database schema."),(0,l.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"This file is not used at all after the ",(0,l.kt)("em",{parentName:"p"},"initial")," installation of your plugin."),(0,l.kt)("p",{parentName:"div"},"It is ",(0,l.kt)("em",{parentName:"p"},"not called")," during any upgrade."))))}W.isMDXComponent=!0;var j=function(e){return i.createElement(o.nR,(0,a.Z)({defaultDescription:W,filepath:"/CHANGES",filetype:"php",summary:"Post-installation hook"},e))},V=["components"],Y={},J={toc:[]};function K(e){var t=e.components,n=(0,r.Z)(e,V);return(0,l.kt)("wrapper",(0,a.Z)({},J,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)(s.Z,(0,a.Z)({frontMatter:Y},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"install.xml")," file is used to define any database tables, fields, indexes, and keys, which should be created for a plugin during its initial installation."),(0,l.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"When creating or updating the ",(0,l.kt)("inlineCode",{parentName:"p"},"install.xml")," you ",(0,l.kt)("strong",{parentName:"p"},"must")," use the built-in ",(0,l.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/XMLDB_Documentation"},"XMLDB editor")," within Moodle."))))}K.isMDXComponent=!0;var Q=function(e){return i.createElement(o.nR,(0,a.Z)({filepath:"/db/install.xml",summary:"Database schema",examplePurpose:"Database schema",defaultDescription:K},e))},ee=["components"],te={},ne={toc:[]};function ae(e){var t=e.components,n=(0,r.Z)(e,ee);return(0,l.kt)("wrapper",(0,a.Z)({},ne,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)(s.Z,(0,a.Z)({frontMatter:te},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"db/messages.php")," file allows you to declare the messages that your plugin sends."),(0,l.kt)("p",null,"See the ",(0,l.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Message_API"},"Message API")," documentation for further information."))}ae.isMDXComponent=!0;var ie=function(e){return i.createElement(o.nR,(0,a.Z)({refreshedDuringUpgrade:!0,defaultExample:"\n$messageproviders = [\n    'things' => [\n        'defaults' => [\n            'airnotifier' => MESSAGE_PERMITTED + MESSAGE_DEFAULT_ENABLED,\n        ],\n    ],\n];\n",defaultDescription:ae,filepath:"/db/messages.php",summary:"Message provider configuration",examplePurpose:"Message provider configuration"},e))},oe=["components"],re={},le={toc:[]};function se(e){var t=e.components,n=(0,r.Z)(e,oe);return(0,l.kt)("wrapper",(0,a.Z)({},le,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)(s.Z,(0,a.Z)({frontMatter:re},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,l.kt)("p",null,"The Moodle Mobile remote add-on is the mobile app version of the plugin that will be loaded when a user accesses the plugin on the app."),(0,l.kt)("p",null,"A plugin can include several Mobile add-ons. Each add-on must indicate a unique name."),(0,l.kt)("p",null,"See the ",(0,l.kt)("a",{parentName:"p",href:"../../moodleapp/development/plugins-development-guide"},"Moodle App Plugins development guide")," for more information on configuring your plugin for the Moodle App."))}se.isMDXComponent=!0;var de=function(e){return i.createElement(o.nR,(0,a.Z)({refreshedDuringUpgrade:!0,defaultDescription:se,filepath:"/db/mobile.php",summary:"MoodleMobile version of the plugin"},e))},pe=["components"],me={},ce={toc:[]};function ue(e){var t=e.components,n=(0,r.Z)(e,pe);return(0,l.kt)("wrapper",(0,a.Z)({},ce,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)(s.Z,(0,a.Z)({frontMatter:me},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,l.kt)("p",null,"Details of classes that have been renamed to fit in with autoloading. See ",(0,l.kt)("a",{parentName:"p",href:"https://moodle.org/mod/forum/discuss.php?d=262403"},"forum discussion")," for details."))}ue.isMDXComponent=!0;var he=function(e){return i.createElement(o.nR,(0,a.Z)({refreshedDuringPurge:!0,defaultExample:"\ndefined('MOODLE_INTERNAL') || die;\n\n$renamedclasses = [\n    'old_class_name' => 'fully_qualified\\\\new\\\\name',\n\n    // Examples:\n    'assign_header' => 'mod_assign\\\\output\\\\header',\n    '\\assign_header' => 'mod_assign\\\\output\\\\header',\n    '\\assign' => 'mod_assign\\\\assignment',\n\n    // Incorrect:\n    // The new class name should _not_ have a leading \\.\n    'assign_header' => '\\\\mod_assign\\\\output\\\\header',\n];\n",defaultDescription:ue,filepath:"/db/renamedclasses.php",summary:"Renamed classes",examplePurpose:"Renamed classes"},e))},fe=["components"],ge={},ve={toc:[]};function ke(e){var t=e.components,n=(0,r.Z)(e,fe);return(0,l.kt)("wrapper",(0,a.Z)({},ve,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)(s.Z,(0,a.Z)({frontMatter:ge},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"db/services.php")," file is used to describe the external functions available for use in web services. This includes\nweb service functions defined for javascript, and for the ",(0,l.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Moodle_Mobile_App"},"Moodle Mobile App"),"."),(0,l.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"Web services should be named following the ",(0,l.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Web_service_API_functions#Naming_convention"},"naming convention for web services"),"."))),(0,l.kt)("p",null,"For further information on external functions and web services, see:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://docs.moodle.org/dev/Adding_a_web_service_to_a_plugin"},"Adding a web service to a plugin")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://docs.moodle.org/dev/Web_services_API"},"Web services API")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://docs.moodle.org/dev/External_functions_API"},"External functions API"))))}ke.isMDXComponent=!0;var ye=function(e){return i.createElement(o.nR,(0,a.Z)({refreshedDuringUpgrade:!0,recommended:!0,filepath:"/db/services.php",summary:"Web service function declarations",examplePurpose:"Web service function declarations",defaultExample:"\n$functions = [\n    'plugintype_pluginname_create_things' => [\n        'classname' => 'plugintype_pluginname\\external\\create_things',\n        'methodname' => 'execute',\n        'description' => 'Create a new thing',\n        'type' => 'write',\n        'capabilities' => 'plugintype/pluginname:create_things',\n        'ajax' => true,\n        'services' => [\n            MOODLE_OFFICIAL_MOBILE_SERVICE,\n        ],\n    ],\n];\n",defaultDescription:ke},e))},Ne=["components"],be={},we={toc:[]};function Me(e){var t=e.components,n=(0,r.Z)(e,Ne);return(0,l.kt)("wrapper",(0,a.Z)({},we,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)(s.Z,(0,a.Z)({frontMatter:be},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"db/uninstall.php")," file allows you define a pre-uninstallation hook, which is called immediately before all table and data from your plugin are removed."))}Me.isMDXComponent=!0;var xe=function(e){return i.createElement(o.nR,(0,a.Z)({defaultDescription:Me,filepath:"/db/uninstall.php",filetype:"php",summary:"Pre-uninstallation hook"},e))},_e=["components"],Te={},Ce={toc:[]};function De(e){var t=e.components,n=(0,r.Z)(e,_e);return(0,l.kt)("wrapper",(0,a.Z)({},Ce,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)(s.Z,(0,a.Z)({frontMatter:Te},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"db/upgrade.php")," file contains upgrade steps, including database schema changes, changes to settings, and other steps which must be performed during upgrade."),(0,l.kt)("p",null,"See the ",(0,l.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Upgrade_API"},"Upgrade API")," documentation for further information."),(0,l.kt)("div",{className:"admonition admonition-danger alert alert--danger"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"Generating Database Schema changes")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"When making changes to the database schema you ",(0,l.kt)("strong",{parentName:"p"},"must")," use the build-in ",(0,l.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/XMLDB_Documentation"},"XMLDB editor")," within\nMoodle. This can be used to generate php upgrade steps."),(0,l.kt)("p",{parentName:"div"},"The ",(0,l.kt)("a",{parentName:"p",href:"#dbinstallxml"},"install.xml")," schema must match the schema generated by the upgrade at all times."))),(0,l.kt)("p",null,"To create an upgrade step you must:"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"Use the ",(0,l.kt)("a",{parentName:"li",href:"https://docs.moodle.org/dev/XMLDB_editor"},"XMLDB editor")," to create the definition of the new fields"),(0,l.kt)("li",{parentName:"ol"},"Update the ",(0,l.kt)("inlineCode",{parentName:"li"},"install.xml")," from the XMLDB editor"),(0,l.kt)("li",{parentName:"ol"},"Generate the PHP upgrade steps from within the XMLDB Editor"),(0,l.kt)("li",{parentName:"ol"},"Update the version number in your ",(0,l.kt)("inlineCode",{parentName:"li"},"version.php"))),(0,l.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"In many cases you will be able to combine multiple upgrade steps into a single version change."))),(0,l.kt)("p",null,"When a version number increment is detected during an upgrade, the ",(0,l.kt)("inlineCode",{parentName:"p"},"xmldb_[pluginname]_upgrade")," function is called with the old version number as the first argument."),(0,l.kt)("p",null,"See the ",(0,l.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Upgrade_API"},"Upgrade API")," documentation for more information on the upgrade process."))}De.isMDXComponent=!0;var Ee=function(e){return i.createElement(o.nR,(0,a.Z)({recommended:!0,defaultDescription:De,defaultExample:"\nfunction xmldb_certificate_upgrade($oldversion = 0) {\n    if ($oldversion < 2012091800) {\n        // Add new fields to certificate table.\n        $table = new xmldb_table('certificate');\n        $field = new xmldb_field('showcode');\n        $field->set_attributes(XMLDB_TYPE_INTEGER, '1', XMLDB_UNSIGNED, XMLDB_NOTNULL, null, '0', 'savecert');\n        if (!$dbman->field_exists($table, $field)) {\n            $dbman->add_field($table, $field);\n        }\n        // Add new fields to certificate_issues table.\n        $table = new xmldb_table('certificate_issues');\n        $field = new xmldb_field('code');\n        $field->set_attributes(XMLDB_TYPE_CHAR, '50', null, null, null, null, 'certificateid');\n        if (!$dbman->field_exists($table, $field)) {\n            $dbman->add_field($table, $field);\n        }\n\n        // Certificate savepoint reached.\n        upgrade_mod_savepoint(true, 2012091800, 'certificate');\n    }\n}",filepath:"/db/upgrade.php",summary:"Upgrade steps",examplePurpose:"Upgrade steps"},e))},Pe=["components"],Ze={},Le={toc:[]};function Ae(e){var t=e.components,n=(0,r.Z)(e,Pe);return(0,l.kt)("wrapper",(0,a.Z)({},Le,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)(s.Z,(0,a.Z)({frontMatter:Ze},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,l.kt)("p",null,"A plugin can declare its own environment requirements, in addition to those declared by Moodle core. These may includes features such as PHP extension requirements, version requirements, and similar items."),(0,l.kt)("p",null,"Further information on this file and its format can be found in the ",(0,l.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Environment_checking"},"Environment checking")," documentation."))}Ae.isMDXComponent=!0;var Ie=function(e){return i.createElement(o.nR,(0,a.Z)({showFileHeader:!1,showLicense:!1,refreshedDuringUpgrade:!0,filepath:"/environment.xml",filetype:"xml",summary:"Plugin-specific environment requirements",defaultDescription:Ae,defaultExample:'\n<?xml version="1.0" encoding="UTF-8" ?>\n<COMPATIBILITY_MATRIX>\n  <PLUGIN name="plugintype_pluginname">\n    <PHP_EXTENSIONS>\n      <PHP_EXTENSION name="soap" level="required">\n      </PHP_EXTENSION>\n    </PHP_EXTENSIONS>\n  </PLUGIN>\n</COMPATIBILITY_MATRIX>'},e))},Re=["components"],Be={},Xe={toc:[]};function Se(e){var t=e.components,n=(0,r.Z)(e,Re);return(0,l.kt)("wrapper",(0,a.Z)({},Xe,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)(s.Z,(0,a.Z)({frontMatter:Be},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,l.kt)("p",null,"Each plugin must define a set of language strings with, at a minimum, an English translation. These are specified in the plugin's ",(0,l.kt)("inlineCode",{parentName:"p"},"lang/en")," directory in a file named after the plugin. For example the LDAP authentication plugin:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-php"},"// Plugin type: `auth`\n// Plugin name: `ldap`\n// Frankenstyle plugin name: `auth_ldap`\n// Plugin location: `auth/ldap`\n// Language string location: `auth/ldap/lang/en/auth_ldap.php`\n")),(0,l.kt)("div",{className:"admonition admonition-warning alert alert--danger"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"Every plugin ",(0,l.kt)("em",{parentName:"p"},"must")," define the name of the plugin, or its ",(0,l.kt)("inlineCode",{parentName:"p"},"pluginname"),"."))),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"get_string")," API can be used to translate a string identifier back into a translated string."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"get_string('pluginname', '[plugintype]_[pluginname]');\n")),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"See the ",(0,l.kt)("a",{parentName:"li",href:"https://docs.moodle.org/dev/String_API#Adding_language_file_to_plugin"},"String API")," documentation for more information on language files.")))}Se.isMDXComponent=!0;var $e=function(e){return i.createElement(o.nR,(0,a.Z)({filepath:"/lang/en/plugintype_pluginname.php",refreshedDuringPurge:!0,required:!0,summary:"Language files",examplePurpose:"Languages configuration",defaultDescription:Se,defaultExample:"$string['pluginname'] = 'The name of my plugin will go here';"},e))},ze=["components"],He={},Ue={toc:[]};function Oe(e){var t=e.components,n=(0,r.Z)(e,ze);return(0,l.kt)("wrapper",(0,a.Z)({},Ue,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)(s.Z,(0,a.Z)({frontMatter:He},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"lib.php")," file is a legacy file which acts as a bridge between Moodle core, and the plugin. In recent plugins it is should only used to define callbacks and related functionality which currently is not supported as an auto-loadable class."),(0,l.kt)("p",null,"All functions defined in this file ",(0,l.kt)("strong",{parentName:"p"},"must")," meet the requirements set out in the relevant section of the ",(0,l.kt)("a",{parentName:"p",href:"/general/development/policies/codingstyle#Functions-and-Methods"},"Coding style"),"."),(0,l.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"Performance impact")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"Moodle core often loads all the ",(0,l.kt)("tt",null,"lib.php")," files of a given plugin types. For performance reasons, it is strongly recommended to keep this file as small as possible and have just required code implemented in it. All the plugin's internal logic should be implemented in the auto-loaded classes."))))}Oe.isMDXComponent=!0;var Fe=function(e){return i.createElement(o.nR,(0,a.Z)({legacy:!0,required:!1,filepath:"/lib.php",summary:"Global plugin functions",examplePurpose:"Plugin functions",defaultDescription:Oe},e))},qe=["components"],Ge={},We={toc:[]};function je(e){var t=e.components,n=(0,r.Z)(e,qe);return(0,l.kt)("wrapper",(0,a.Z)({},We,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)(s.Z,(0,a.Z)({frontMatter:Ge},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,l.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"Legacy feature")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"The use of this file is no longer recommended, and new uses of it will not be permitted in core code."))),(0,l.kt)("p",null,"Rather than creating global functions in a global namespace in a ",(0,l.kt)("tt",null,"locallib.php")," file, you should use autoloaded classes which are located in the ",(0,l.kt)("tt",null,"classes/")," directory."),(0,l.kt)("p",null,"Where this file is in use, all functions ",(0,l.kt)("strong",{parentName:"p"},"must")," meet the requirements set out in the relevant section of the ",(0,l.kt)("a",{parentName:"p",href:"/general/development/policies/codingstyle#Functions-and-Methods"},"Coding style")),(0,l.kt)("p",null,"Existing functions which have been incorrectly named ",(0,l.kt)("strong",{parentName:"p"},"will not")," be accepted as an example of an existing convention. Existing functions which are incorrectly named ",(0,l.kt)("strong",{parentName:"p"},"should")," be converted to use a namespaced class."))}je.isMDXComponent=!0;var Ve=function(e){return i.createElement(o.nR,(0,a.Z)({defaultDescription:je,filepath:"/locallib.php",legacy:!0,required:!1,summary:"Global support functions"},e))},Ye=["components"],Je={},Ke={toc:[]};function Qe(e){var t=e.components,n=(0,r.Z)(e,Ye);return(0,l.kt)("wrapper",(0,a.Z)({},Ke,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)(s.Z,(0,a.Z)({frontMatter:Je},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,l.kt)("p",null,"Plugins can provide icons in several formats, and most plugin types require that a default icon be provided."),(0,l.kt)("p",null,"Where a browser supports it, the ",(0,l.kt)("inlineCode",{parentName:"p"},"svg")," format is used, falling back to ",(0,l.kt)("inlineCode",{parentName:"p"},"png")," formats when an SVG is unavailable."),(0,l.kt)("p",null,"Full details of the correct naming, sizing, and design guidelines for icons in Moodle can be found in the ",(0,l.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Moodle_icons"},"Moodle icons")," documentation."))}Qe.isMDXComponent=!0;var et=function(e){return i.createElement(o.nR,(0,a.Z)({defaultDescription:Qe,refreshedDuringPurge:!0,filepath:"/pix/",summary:"Plugins icons"},e))},tt=["components"],nt={},at={toc:[]};function it(e){var t=e.components,n=(0,r.Z)(e,tt);return(0,l.kt)("wrapper",(0,a.Z)({},at,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)(s.Z,(0,a.Z)({frontMatter:nt},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,l.kt)("p",null,"We recommend that you include any additional information for your plugin in a project readme file. Ideally this should act as an offline version of all information in your plugin's page in the ",(0,l.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Plugins_directory"},"Plugins directory"),"."),(0,l.kt)("p",null,"We recommend creating your readme file in either a ",(0,l.kt)("inlineCode",{parentName:"p"},"README.md"),", or ",(0,l.kt)("inlineCode",{parentName:"p"},"README.txt")," format."))}it.isMDXComponent=!0;var ot=function(e){return i.createElement(o.nR,(0,a.Z)({filepath:"/README",recommended:!0,defaultDescription:it,summary:"Plugin Information for Administrators"},e))},rt=["components"],lt={},st={toc:[]};function dt(e){var t=e.components,n=(0,r.Z)(e,rt);return(0,l.kt)("wrapper",(0,a.Z)({},st,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)(s.Z,(0,a.Z)({frontMatter:lt},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,l.kt)("p",null,"When importing a third-party library into your plugin, it is advisable to create a ",(0,l.kt)("inlineCode",{parentName:"p"},"readme_moodle.txt")," file detailing relevant information, including:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Download URLs"),(0,l.kt)("li",{parentName:"ul"},"Build instructions")))}dt.isMDXComponent=!0;var pt=function(e){return i.createElement(o.nR,(0,a.Z)({recommended:!0,filepath:"/*/readme_moodle.txt",defaultDescription:dt,summary:"Third-party library import instructions"},e))},mt=["components"],ct={},ut={toc:[]};function ht(e){var t=e.components,n=(0,r.Z)(e,mt);return(0,l.kt)("wrapper",(0,a.Z)({},ut,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)(s.Z,(0,a.Z)({frontMatter:ct},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,l.kt)("p",null,"You can define settings for your plugin that the administrator can configure by creating a ",(0,l.kt)("inlineCode",{parentName:"p"},"settings.php")," file in the root of your plugins' directory."),(0,l.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"Settings must named in the following format:"),(0,l.kt)("pre",{parentName:"div"},(0,l.kt)("code",{parentName:"pre"},"plugintype_pluginname/settingname\n")),(0,l.kt)("p",{parentName:"div"},"By following the correct naming, all settings will automatically be stored in the ",(0,l.kt)("inlineCode",{parentName:"p"},"config_plugins")," database table."))),(0,l.kt)("p",null,"Full details on how to create settings are available in the ",(0,l.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Admin_settings"},"Admin settings")," documentation."))}ht.isMDXComponent=!0;var ft=function(e){return i.createElement(o.nR,(0,a.Z)({defaultDescription:ht,filepath:"/settings.php",summary:"Plugin settings",examplePurpose:"Plugin settings"},e))},gt=["components"],vt={},kt={toc:[]};function yt(e){var t=e.components,n=(0,r.Z)(e,gt);return(0,l.kt)("wrapper",(0,a.Z)({},kt,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)(s.Z,(0,a.Z)({frontMatter:vt},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,l.kt)("p",null,"Plugins may define a '/styles.css' to provide plugin-specific styling. See the following for further documentation:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://docs.moodle.org/dev/Plugin_contribution_checklist#CSS_styles"},"Plugin contribution checklist#CSS styles")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://docs.moodle.org/dev/CSS_Coding_Style"},"CSS Coding Style"))),(0,l.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Avoid custom styles where possible")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"Rather than writing custom CSS for your plugin, where possible apply Bootstrap classes to the DOM elements in your output. These will be easier to maintain and will adopt most colour, branding, and other customisations applied to a theme."))))}yt.isMDXComponent=!0;var Nt=function(e){return i.createElement(o.nR,(0,a.Z)({refreshedDuringPurge:!0,defaultDescription:yt,filepath:"/styles.css",summary:"CSS style sheet for your plugin"},e))},bt=["components"],wt={},Mt={toc:[]};function xt(e){var t=e.components,n=(0,r.Z)(e,bt);return(0,l.kt)("wrapper",(0,a.Z)({},Mt,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)(s.Z,(0,a.Z)({frontMatter:wt},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,l.kt)("p",null,"Details of all third-party libraries should be declared in the ",(0,l.kt)("inlineCode",{parentName:"p"},"thirdpartylibs.xml")," file."),(0,l.kt)("p",null,"This information is used to generate ignore file configuration for linting tools. For Moodle core it is also used to generate library information as part of release notes and credits."),(0,l.kt)("p",null,"Within the XML the ",(0,l.kt)("inlineCode",{parentName:"p"},"location")," is a file, or directory, relative to your plugin's root."),(0,l.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"Licensing")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"The license of any third-party code included in your plugin, and within the ",(0,l.kt)("inlineCode",{parentName:"p"},"thirdpartylibs.xml")," file ",(0,l.kt)("strong",{parentName:"p"},"must")," be ",(0,l.kt)("a",{parentName:"p",href:"http://www.gnu.org/licenses/license-list.html#GPLCompatibleLicenses"},"compatible with the GNU GPLv3"),"."))),(0,l.kt)("p",null,"See the ",(0,l.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Third_Party_Libraries"},"Third Party Libraries")," documentation for further information."))}xt.isMDXComponent=!0;var _t=function(e){return i.createElement(o.nR,(0,a.Z)({defaultDescription:xt,defaultExample:'<?xml version="1.0"?>\n<libraries>\n    <library>\n        <location>javascript/html5shiv.js</location>\n        <name>Html5Shiv</name>\n        <version>3.6.2</version>\n        <license>Apache</license>\n        <licenseversion>2.0</licenseversion>\n    </library>\n    <library>\n        <location>vendor/guzzle/guzzle/</location>\n        <name>guzzle</name>\n        <version>v3.9.3</version>\n        <license>MIT</license>\n        <licenseversion></licenseversion>\n    </library>\n</libraries>',filepath:"/thirdpartylibs.xml",filetype:"xml",summary:"Details of third-party libraries includedin the plugin",showLicense:!1,showFileHeader:!1},e))},Tt=["components"],Ct={},Dt={toc:[]};function Et(e){var t=e.components,n=(0,r.Z)(e,Tt);return(0,l.kt)("wrapper",(0,a.Z)({},Dt,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)(s.Z,(0,a.Z)({frontMatter:Ct},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,l.kt)("p",null,"Each component and subsystem may make use of an ",(0,l.kt)("inlineCode",{parentName:"p"},"upgrade.txt")," file in the top level folder. A title is used to identify the Moodle version where the change was introduced, and significant changes for that version relating to that component or subsystem are displayed."),(0,l.kt)("p",null,"When changes are integrated to multiple branches, for example a stable version and the master branch, then the relevant versions used to describe the change in the ",(0,l.kt)("inlineCode",{parentName:"p"},"upgrade.txt")," file should be the next version to be released ",(0,l.kt)("em",{parentName:"p"},"for each branch"),". The ",(0,l.kt)("inlineCode",{parentName:"p"},"master")," branch should always use the next major version."),(0,l.kt)("p",null,"For example if a change is applied to the ",(0,l.kt)("strong",{parentName:"p"},"MOODLE_400_STABLE")," during the development of Moodle 4.0.2, and the ",(0,l.kt)("strong",{parentName:"p"},"master")," branch during the development of Moodle 4.1, then the relevant versions will be ",(0,l.kt)("strong",{parentName:"p"},"4.0.2")," and ",(0,l.kt)("strong",{parentName:"p"},"4.1"),"."),(0,l.kt)("p",null,"If a change is only applied to the master branch then only the ",(0,l.kt)("strong",{parentName:"p"},"4.1")," version will be listed."),(0,l.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"Exception during parallel development")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"When Moodle is developing two major versions in parallel, for example Moodle 3.11.0, and Moodle 4.0.0, then the\nversion in the earliest of the major version development branches will be used for both branches."),(0,l.kt)("p",{parentName:"div"},"For example, during the development of Moodle 3.11, and Moodle 4.0, which took place in parallel, if a change was integrated to 3.11 and 4.0, then the version specified in both branches would be 3.11."))))}Et.isMDXComponent=!0;var Pt=function(e){return i.createElement(o.nR,(0,a.Z)({recommended:!0,filepath:"/*/upgrade.txt",defaultDescription:Et,summary:"Significant changes for each version of your plugin"},e))},Zt=["components"],Lt={},At={toc:[]};function It(e){var t=e.components,n=(0,r.Z)(e,Zt);return(0,l.kt)("wrapper",(0,a.Z)({},At,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)(s.Z,(0,a.Z)({frontMatter:Lt},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,l.kt)("p",null,"The version.php contains metadata about the plugin."),(0,l.kt)("p",null,"It is used during the installation and upgrade of the plugin."),(0,l.kt)("p",null,"This file contains metadata used to describe the plugin, and includes information such as:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"the version number"),(0,l.kt)("li",{parentName:"ul"},"a list of dependencies"),(0,l.kt)("li",{parentName:"ul"},"the minimum Moodle version required"),(0,l.kt)("li",{parentName:"ul"},"maturity of the plugin")))}It.isMDXComponent=!0;function Rt(e){return i.createElement(o.nR,(0,a.Z)({required:!0,filepath:"/version.php",filetype:"php",summary:"Version metadata",examplePurpose:"Version metadata",defaultDescription:It,defaultExample:"defined('MOODLE_INTERNAL') || die();\n\n$plugin->version = TODO;\n$plugin->requires = TODO;\n$plugin->supported = TODO;   // Available as of Moodle 3.9.0 or later.\n$plugin->incompatible = TODO;   // Available as of Moodle 3.9.0 or later.\n$plugin->component = 'TODO_FRANKENSTYLE';\n$plugin->maturity = MATURITY_STABLE;\n$plugin->release = 'TODO';\n\n$plugin->dependencies = [\n    'mod_forum' => 2022042100,\n    'mod_data' => 2022042100\n];\n"},e))}var Bt=["components"],Xt={},St={toc:[]};function $t(e){var t=e.components,n=(0,r.Z)(e,Bt);return(0,l.kt)("wrapper",(0,a.Z)({},St,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)(s.Z,(0,a.Z)({frontMatter:Xt},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,l.kt)("p",null,"In older versions of Moodle, JavaScript was written in the YUI format. This is being phased out in favour of ",(0,l.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Javascript_Modules"},"Javascript Modules"),", although some older uses still remain in Moodle core."),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://docs.moodle.org/dev/YUI/Modules"},"YUI/Modules")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://docs.moodle.org/dev/YUI"},"YUI"))),(0,l.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"New YUI code will not be accepted into Moodle core, except for new plugins for the ",(0,l.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/Atto"},"Atto editor"),"."))))}$t.isMDXComponent=!0;var zt=function(e){return i.createElement(o.nR,(0,a.Z)({legacy:!0,refreshedDuringPurge:!0,defaultDescription:$t,filepath:"/yui/",examplePurpose:"YUI JavaScript Modules",summary:"YUI JavaScript Modules"},e))}},80069:function(e,t,n){n.d(t,{Z:function(){return p}});var a=n(67294),i=n(87918),o=n(80684),r=n(86886),l=n(34673),s=n(3905),d=function(e,t,n){return void 0===n&&(n="info"),a.createElement(r.ZP,{item:!0,key:e},a.createElement(o.Z,{title:t},a.createElement(i.Z,{label:e,color:n})))};function p(e){var t=e.filepath,n=e.summary,i=function(e){var t=e.required,n=void 0!==t&&t,a=e.legacy,i=void 0!==a&&a,o=e.deprecated,r=void 0!==o&&o,l=e.refreshedDuringUpgrade,s=void 0!==l&&l,p=e.refreshedDuringPurge,m=void 0!==p&&p,c=[];return s&&c.push(d("Upgradable","Changes to this file or directory will be re-applied during a Moodle upgrade. If you make any changes to it, you can simply increment the version number and perform a Moodle upgrade.","info")),m&&c.push(d("Refreshed on cache purge","The contents of this file or directory are cached. To see your changes you can simply purge Moodle's caches and refresh the page.","info")),n&&c.push(d("Required","This file must be present","success")),i&&c.push(d("Legacy","Use of this file is being phased out. It is still supported for older installations but will be removed..","warning")),r&&c.push(d("Deprecated","Use of this file is deprecated and not recommended.It may still be provided for older versions of Moodle but is no longer used.","error")),c}(e),o=e.description?a.createElement(r.ZP,{item:!0,xs:12},e.description):null;return a.createElement(s.Zo,null,a.createElement(r.ZP,{container:!0,spacing:2},a.createElement(r.ZP,{item:!0,xs:6},a.createElement("h4",null,n)),a.createElement(r.ZP,{item:!0,xs:6},a.createElement(r.ZP,{container:!0,spacing:2,justifyContent:"flex-end"},i)),a.createElement(r.ZP,{item:!0,xs:12},a.createElement("h5",null,"File path:"," ",t)),o,function(e){var t=e.example,n=e.open,i=void 0!==n&&n;return t?a.createElement(r.ZP,{item:!0,xs:12},a.createElement(l.Z,{summary:a.createElement("summary",null,"View example"),open:i},t)):null}(e)))}},78989:function(e,t,n){n.d(t,{W7:function(){return c}});var a,i=n(67294),o=n(46975),r=JSON.parse('{"plugintypes":{"antivirus":"lib/antivirus","availability":"availability/condition","qtype":"question/type","mod":"mod","auth":"auth","calendartype":"calendar/type","customfield":"customfield/field","enrol":"enrol","message":"message/output","block":"blocks","media":"media/player","filter":"filter","editor":"lib/editor","format":"course/format","dataformat":"dataformat","profilefield":"user/profile/field","report":"report","coursereport":"course/report","gradeexport":"grade/export","gradeimport":"grade/import","gradereport":"grade/report","gradingform":"grade/grading/form","mlbackend":"lib/mlbackend","mnetservice":"mnet/service","webservice":"webservice","repository":"repository","portfolio":"portfolio","search":"search/engine","qbank":"question/bank","qbehaviour":"question/behaviour","qformat":"question/format","plagiarism":"plagiarism","tool":"admin/tool","cachestore":"cache/stores","cachelock":"cache/locks","fileconverter":"files/converter","contenttype":"contentbank/contenttype","theme":"theme","local":"local","h5plib":"h5p/h5plib","paygw":"payment/gateway"},"subsystems":{"access":null,"admin":"admin","adminpresets":"admin/presets","analytics":"analytics","antivirus":"lib/antivirus","auth":"auth","availability":"availability","backup":"backup/util/ui","badges":"badges","block":"blocks","blog":"blog","bulkusers":null,"cache":"cache","calendar":"calendar","cohort":"cohort","comment":"comment","competency":"competency","completion":"completion","contentbank":"contentbank","countries":null,"course":"course","courseformat":"course/format","currencies":null,"customfield":"customfield","dbtransfer":null,"debug":null,"editor":"lib/editor","edufields":null,"enrol":"enrol","error":null,"favourites":"favourites","filepicker":null,"fileconverter":"files/converter","files":"files","filters":"filter","form":"lib/form","grades":"grade","grading":"grade/grading","group":"group","help":null,"hub":null,"h5p":"h5p","imscc":null,"install":null,"iso6392":null,"langconfig":null,"license":null,"mathslib":null,"media":"media","message":"message","mimetypes":null,"mnet":"mnet","my":"my","notes":"notes","pagetype":null,"payment":"payment","pix":null,"plagiarism":"plagiarism","plugin":null,"portfolio":"portfolio","privacy":"privacy","question":"question","rating":"rating","reportbuilder":"reportbuilder","repository":"repository","rss":"rss","role":"admin/roles","search":"search","table":"lib/table","tag":"tag","timezones":null,"user":"user","userkey":"lib/userkey","webservice":"webservice","xapi":"lib/xapi"}}'),l=function(e){return function(t){var n=t.plugintype,a=void 0===n?"plugintype":n,i=t.pluginname,o=void 0===i?"pluginname":i,r=t.filepath,l=void 0===r?null:r,s=function(e){return function(t){return e.plugintypes[t]?e.plugintypes[t]:"[path/to/"+t+"]"}}(e)(a);return""+(s+=o?"/"+o:"/[pluginname]")+l}},s=l(r),d=(s(r),function(e){if(!e.showFileHeader)return"";switch(null==e?void 0:e.filetype){case"xml":return"";case"js":case"javascript":return function(e){var t=e.plugintype,n=void 0===t?"plugintype":t,a=e.pluginname,i=void 0===a?"pluginname":a,o=e.examplePurpose,r=e.modulename;if(!o)throw Error("Purpose must be specified");if(!r)throw Error("AMD Module name must be specified");return["/**"," * "+o+" for the "+n+"_"+i+" plugin."," *"," * @module   "+n+"_"+i+"/"+r," * @copyright Year, You Name <your@email.address>"," * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later"," */",""].join("\n")}(e);default:return function(e){var t=e.plugintype,n=void 0===t?"plugintype":t,a=e.pluginname,i=void 0===a?"pluginname":a,o=e.examplePurpose;if(!o)throw Error("Purpose must be specified");return["/**"," * "+o+" for the "+n+"_"+i+" plugin."," *"," * @package   "+n+"_"+i," * @copyright Year, You Name <your@email.address>"," * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later"," */",""].join("\n")}(e)}}),p=function(e){return e.showLicense?(e.filetype,"// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n"):""},m=function(e){var t=e.filetype,n=void 0===t?"php":t;switch(n){case"js":case"javascript":return"javascript";case"xml":return"xml";case"php":case null:return"php";default:return n}},c=(a=r,function(e,t){var n,r=Object.assign({plugintype:"plugintype",showLicense:!0,showFileHeader:!0,filepath:null!=(n=e.exampleFilepath)?n:e.filepath},e),s=l(a),c=function(e,t){void 0===t&&(t=null);var n=[p(e),d(e),e.example?e.example:t||null].filter((function(e){return e})).map((function(e){return e.trim()})).join("\n\n");return[function(e){var t=e.filetype;switch(void 0===t?"php":t){case"js":case"javascript":case"xml":return null;default:return"<?php"}}(e),n].filter((function(e){return e})).join("\n")}(r,t);return i.createElement(o.Z,{title:s(r),language:m(r)},c)})},95568:function(e,t,n){n.r(t),n.d(t,{accessExample:function(){return Z},assets:function(){return E},contentTitle:function(){return C},default:function(){return A},frontMatter:function(){return T},metadata:function(){return D},toc:function(){return P}});var a=n(83117),i=n(80102),o=n(67294),r=n(3905),l=n(13904),s=n(95757),d=n(60620),p=["components"],m={},c={toc:[]};function u(e){var t=e.components,n=(0,i.Z)(e,p);return(0,r.kt)("wrapper",(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)(l.Z,(0,a.Z)({frontMatter:m},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,r.kt)("p",null,"This file is used when adding/editing a module to a course. It contains the elements that will be displayed on the form responsible for creating/installing an instance of your module. The class in the file should be called ",(0,r.kt)("inlineCode",{parentName:"p"},"mod_[modname]_mod_form"),"."),(0,r.kt)("div",{className:"admonition admonition-warning alert alert--danger"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"warning")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"The ",(0,r.kt)("inlineCode",{parentName:"p"},"mod_[modname]_mod_form")," is a current exception to the class autoloading rules."),(0,r.kt)("p",{parentName:"div"},"This will be addressed in ",(0,r.kt)("a",{parentName:"p",href:"https://tracker.moodle.org/browse/MDL-74472"},"MDL-74472"),"."))),(0,r.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"The following example gives a sample implementation of the creation form. It does ",(0,r.kt)("strong",{parentName:"p"},"not")," contain the full file."))))}u.isMDXComponent=!0;var h=function(e){return o.createElement(d.nR,(0,a.Z)({required:!0,defaultDescription:u,defaultExample:"require_once($CFG->dirroot.'/course/moodleform_mod.php');\nrequire_once($CFG->dirroot.'/mod/certificate/lib.php');\n\nclass mod_certificate_mod_form extends moodleform_mod {\n\n    function definition() {\n        global $CFG, $DB, $OUTPUT;\n\n        $mform =& $this->_form;\n\n        $mform->addElement('text', 'name', get_string('certificatename', 'certificate'), ['size'=>'64']);\n        $mform->setType('name', PARAM_TEXT);\n        $mform->addRule('name', null, 'required', null, 'client');\n\n        $ynoptions = [\n            0 => get_string('no'),\n            1 => get_string('yes'),\n        ];\n        $mform->addElement('select', 'usecode', get_string('usecode', 'certificate'), $ynoptions);\n        $mform->setDefault('usecode', 0);\n        $mform->addHelpButton('usecode', 'usecode', 'certificate');\n\n        $this->standard_coursemodule_elements();\n\n        $this->add_action_buttons();\n    }\n",examplePurpose:"Activity creation/editing form",filepath:"/mod_form.php",pluginname:"[modname]",plugintype:"mod",summary:"Activity creation/editing form"},e))},f=["components"],g={},v={toc:[]};function k(e){var t=e.components,n=(0,i.Z)(e,f);return(0,r.kt)("wrapper",(0,a.Z)({},v,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)(l.Z,(0,a.Z)({frontMatter:g},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"index.php")," should be used to list all instances of an activity that the current user has access to in the specified course."))}k.isMDXComponent=!0;var y=function(e){return o.createElement(d.nR,(0,a.Z)({required:!0,defaultDescription:k,defaultExample:"require_once('../../config.php');\n\n// The `id` parameter is the course id.\n$id = required_param('id', PARAM_INT);\n\n// Fetch the requested course.\n$course = $DB->get_record('course', ['id'=> $id], '*', MUST_EXIST);\n\n// Require that the user is logged into the course.\nrequire_course_login($course);\n\n$modinfo = get_fast_modinfo($course);\n\nforeach ($modinfo->get_instances_of('[modinfo]') as $instanceid => $cm) {\n    // Display information about your activity.\n}\n",plugintype:"mod",pluginname:"[modname]",filepath:"/index.php",summary:"Activity index",examplePurpose:"Activity index"},e))},N=["components"],b={},w={toc:[]};function M(e){var t=e.components,n=(0,i.Z)(e,N);return(0,r.kt)("wrapper",(0,a.Z)({},w,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)(l.Z,(0,a.Z)({frontMatter:b},"undefined"!=typeof metadata?{metadata:metadata}:{},{mdxType:"MoodlePageBanner"})),(0,r.kt)("p",null,"Moodle will automatically generate links to view the activity using the ",(0,r.kt)("inlineCode",{parentName:"p"},"/view.php")," page and passing in an ",(0,r.kt)("inlineCode",{parentName:"p"},"id")," value. The ",(0,r.kt)("inlineCode",{parentName:"p"},"id")," passed is the course module ID, which can be used to fetch all remaining data for the activity instance."))}M.isMDXComponent=!0;var x=function(e){return o.createElement(d.nR,(0,a.Z)({refreshedDuringPurge:!0,filepath:"/view.php",summary:"Activity view page",examplePurpose:"Activity view page",defaultDescription:M,defaultExample:"\nrequire('../../config.php');\n\n$id = required_param('id', PARAM_INT);\n[$course, $cm] = get_course_and_cm_from_cmid($id, '[modname]');\n$instance = $DB->get_record('[modname]', ['id'=> $cm->instance], '*', MUST_EXIST);\n"},e))},_=["components"],T={title:"Activity modules",toc_max_heading_level:4,tags:["API","Activity","Module","mod"]},C=void 0,D={unversionedId:"apis/plugintypes/mod/index",id:"apis/plugintypes/mod/index",title:"Activity modules",description:"Activity modules are a fundamental course feature and are usually the primary delivery method for learning content in Moodle.",source:"@site/docs/apis/plugintypes/mod/index.mdx",sourceDirName:"apis/plugintypes/mod",slug:"/apis/plugintypes/mod/",permalink:"/devdocs/docs/apis/plugintypes/mod/",draft:!1,editUrl:"https://github.com/moodle/devdocs/edit/main/docs/apis/plugintypes/mod/index.mdx",tags:[{label:"API",permalink:"/devdocs/docs/tags/api"},{label:"Activity",permalink:"/devdocs/docs/tags/activity"},{label:"Module",permalink:"/devdocs/docs/tags/module"},{label:"mod",permalink:"/devdocs/docs/tags/mod"}],version:"current",lastUpdatedBy:"Sara Arjona",lastUpdatedAt:1654608238,formattedLastUpdatedAt:"07/06/2022",frontMatter:{title:"Activity modules",toc_max_heading_level:4,tags:["API","Activity","Module","mod"]},sidebar:"docs",previous:{title:"Machine learning backends",permalink:"/devdocs/docs/apis/plugintypes/mlbackend/"},next:{title:"Question Bank plugins",permalink:"/devdocs/docs/apis/plugintypes/qbank/"}},E={},P=[{value:"Folder layout",id:"folder-layout",level:2},{value:"Standard Files and their Functions",id:"standard-files-and-their-functions",level:2},{value:"Backup Folder",id:"backup-folder",level:3},{value:"<code>access.php</code> - Capability defaults",id:"accessphp---capability-defaults",level:3},{value:"<code>events.php</code> - Event observers",id:"eventsphp---event-observers",level:3},{value:"<code>install.xml</code> - Database installation",id:"installxml---database-installation",level:3},{value:"<code>upgrade.php</code> - Upgrade steps",id:"upgradephp---upgrade-steps",level:3},{value:"<code>mobile.php</code> - Moodle Mobile Remote Add-ons",id:"mobilephp---moodle-mobile-remote-add-ons",level:3},{value:"<code>/lang/en/mod_[modname].php</code> - Language string definitions",id:"langenmod_modnamephp---language-string-definitions",level:3},{value:"<code>lib.php</code> - Library functions",id:"libphp---library-functions",level:3},{value:"<code>mod_form.php</code> - Instance create/edit form",id:"mod_formphp---instance-createedit-form",level:3},{value:"<code>index.php</code> - Instance list",id:"indexphp---instance-list",level:3},{value:"<code>view.php</code> - View an activity",id:"viewphp---view-an-activity",level:3},{value:"<code>version.php</code>",id:"versionphp",level:3},{value:"See also",id:"see-also",level:2}],Z="\n$capabilities = [\n    'mod/[modname]:addinstance' => [\n        'riskbitmask' => RISK_XSS,\n        'captype' => 'write',\n        'contextlevel' => CONTEXT_COURSE,\n        'archetypes' => [\n            'editingteacher' => CAP_ALLOW,\n            'manager' => CAP_ALLOW,\n        ],\n        'clonepermissionsfrom' => 'moodle/course:manageactivities',\n    ],\n    'mod/[modname]:view' => [\n        'captype' => 'read',\n        'contextlevel' => CONTEXT_MODULE,\n        'archetypes' => [\n            'guest' => CAP_ALLOW,\n            'student' => CAP_ALLOW,\n            'teacher' => CAP_ALLOW,\n            'editingteacher' => CAP_ALLOW,\n            'manager' => CAP_ALLOW,\n        ],\n    ],\n];\n",L={toc:P,accessExample:Z};function A(e){var t=e.components,n=(0,i.Z)(e,_);return(0,r.kt)("wrapper",(0,a.Z)({},L,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)(l.Z,(0,a.Z)({frontMatter:T},void 0!==D?{metadata:D}:{},{mdxType:"MoodlePageBanner"})),(0,r.kt)("p",null,"Activity modules are a fundamental course feature and are usually the primary delivery method for learning content in Moodle."),(0,r.kt)("p",null,"The plugintype of an Activity module is ",(0,r.kt)("inlineCode",{parentName:"p"},"mod"),", and the frankenstyle name of a plugin is therefore ",(0,r.kt)("inlineCode",{parentName:"p"},"mod_[modname]"),"."),(0,r.kt)("p",null,"All activity module plugins are located in the ",(0,r.kt)("inlineCode",{parentName:"p"},"/mod/")," folder of Moodle."),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"The term ",(0,r.kt)("inlineCode",{parentName:"p"},"[modname]")," is used as a placeholder in this documentation and should be replaced with the name of your activity module."))),(0,r.kt)("h2",{id:"folder-layout"},"Folder layout"),(0,r.kt)("p",null,"Activity modules reside in the ",(0,r.kt)("inlineCode",{parentName:"p"},"/mod")," directory."),(0,r.kt)("p",null,"Each module is in a separate subdirectory and consists of a number of ",(0,r.kt)("em",{parentName:"p"},"mandatory files")," and any other files the developer is going to use."),(0,r.kt)("p",null,"Below is an example of the file structure for the ",(0,r.kt)("inlineCode",{parentName:"p"},"folder")," plugin."),(0,r.kt)("details",null,(0,r.kt)("summary",null,"View an example directory layout for the `folder` plugin."),(0,r.kt)("div",null,(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-console"},".\n\u251c\u2500\u2500 backup\n\u2502\xa0\xa0 \u251c\u2500\u2500 moodle1\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 lib.php\n\u2502\xa0\xa0 \u2514\u2500\u2500 moodle2\n\u2502\xa0\xa0     \u251c\u2500\u2500 backup_folder_activity_task.class.php\n\u2502\xa0\xa0     \u251c\u2500\u2500 backup_folder_stepslib.php\n\u2502\xa0\xa0     \u251c\u2500\u2500 restore_folder_activity_task.class.php\n\u2502\xa0\xa0     \u2514\u2500\u2500 restore_folder_stepslib.php\n\u251c\u2500\u2500 classes\n\u2502\xa0\xa0 \u251c\u2500\u2500 analytics\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 indicator\n\u2502\xa0\xa0 \u2502\xa0\xa0     \u251c\u2500\u2500 activity_base.php\n\u2502\xa0\xa0 \u2502\xa0\xa0     \u251c\u2500\u2500 cognitive_depth.php\n\u2502\xa0\xa0 \u2502\xa0\xa0     \u2514\u2500\u2500 social_breadth.php\n\u2502\xa0\xa0 \u251c\u2500\u2500 content\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 exporter.php\n\u2502\xa0\xa0 \u251c\u2500\u2500 event\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 all_files_downloaded.php\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 course_module_instance_list_viewed.php\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u251c\u2500\u2500 course_module_viewed.php\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 folder_updated.php\n\u2502\xa0\xa0 \u251c\u2500\u2500 external.php\n\u2502\xa0\xa0 \u251c\u2500\u2500 privacy\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 provider.php\n\u2502\xa0\xa0 \u2514\u2500\u2500 search\n\u2502\xa0\xa0     \u2514\u2500\u2500 activity.php\n\u251c\u2500\u2500 db\n\u2502\xa0\xa0 \u251c\u2500\u2500 access.php\n\u2502\xa0\xa0 \u251c\u2500\u2500 install.php\n\u2502\xa0\xa0 \u251c\u2500\u2500 install.xml\n\u2502\xa0\xa0 \u251c\u2500\u2500 log.php\n\u2502\xa0\xa0 \u251c\u2500\u2500 services.php\n\u2502\xa0\xa0 \u2514\u2500\u2500 upgrade.php\n\u251c\u2500\u2500 download_folder.php\n\u251c\u2500\u2500 edit.php\n\u251c\u2500\u2500 edit_form.php\n\u251c\u2500\u2500 index.php\n\u251c\u2500\u2500 lang\n\u2502\xa0\xa0 \u2514\u2500\u2500 en\n\u2502\xa0\xa0     \u2514\u2500\u2500 folder.php\n\u251c\u2500\u2500 lib.php\n\u251c\u2500\u2500 locallib.php\n\u251c\u2500\u2500 mod_form.php\n\u251c\u2500\u2500 module.js\n\u251c\u2500\u2500 phpunit.xml\n\u251c\u2500\u2500 pix\n\u2502\xa0\xa0 \u251c\u2500\u2500 icon.png\n\u2502\xa0\xa0 \u2514\u2500\u2500 icon.svg\n\u251c\u2500\u2500 readme.txt\n\u251c\u2500\u2500 renderer.php\n\u251c\u2500\u2500 settings.php\n\u251c\u2500\u2500 styles.css\n\u251c\u2500\u2500 tests\n\u2502\xa0\xa0 \u251c\u2500\u2500 backup\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 restore_date_test.php\n\u2502\xa0\xa0 \u251c\u2500\u2500 behat\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 folder_activity_completion.feature\n\u2502\xa0\xa0 \u251c\u2500\u2500 event\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 events_test.php\n\u2502\xa0\xa0 \u251c\u2500\u2500 externallib_test.php\n\u2502\xa0\xa0 \u251c\u2500\u2500 generator\n\u2502\xa0\xa0 \u2502\xa0\xa0 \u2514\u2500\u2500 lib.php\n\u2502\xa0\xa0 \u251c\u2500\u2500 generator_test.php\n\u2502\xa0\xa0 \u251c\u2500\u2500 lib_test.php\n\u2502\xa0\xa0 \u251c\u2500\u2500 phpunit.xml\n\u2502\xa0\xa0 \u2514\u2500\u2500 search\n\u2502\xa0\xa0     \u2514\u2500\u2500 search_test.php\n\u251c\u2500\u2500 version.php\n\u2514\u2500\u2500 view.php\n")))),(0,r.kt)("h2",{id:"standard-files-and-their-functions"},"Standard Files and their Functions"),(0,r.kt)("p",null,"There are several files that are crucial to Moodle. These files are used to install your module and then integrate it into Moodle. Each file has a particular function, some of the files are optional, and are only created if you want to use the functionality it offers. Below are the list of most commonly used files."),(0,r.kt)("h3",{id:"backup-folder"},"Backup Folder"),(0,r.kt)(s.dk,{mdxType:"BackupDir"}),(0,r.kt)("h3",{id:"accessphp---capability-defaults"},(0,r.kt)("inlineCode",{parentName:"h3"},"access.php")," - Capability defaults"),(0,r.kt)(s.MC,{example:Z,showFileHeader:!1,showLicense:!1,plugintype:"mod",pluginname:"[modname]",extraDescription:(0,r.kt)("div",null,(0,r.kt)("p",null,"For activities the following capabilities are ",(0,r.kt)("em",{parentName:"p"},"required"),":"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"mod/[modname]:addinstance"),": Controls whether a user may create a new instance of the activity"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"mod/[modname]:view"),": Controls whether a user may view an instance of the activity")),(0,r.kt)("p",null,"The example below shows the recommended configuration for the ",(0,r.kt)("inlineCode",{parentName:"p"},"addinstance")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"view")," capabilities."),(0,r.kt)("p",null,"This configuration will allow:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"editing teachers and managers to create new instances, but not non-editing teachers."),(0,r.kt)("li",{parentName:"ul"},"all roles to view the activity.")),(0,r.kt)("div",{className:"admonition admonition-important alert alert--info"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"important")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Granting the view capability to archetypes like ",(0,r.kt)("inlineCode",{parentName:"p"},"guest")," does not allow any user to view all activities. Users are still subject to standard access controls like course enrolment."))),(0,r.kt)("p",null,"For further information on what each attribute in that capabilities array means visit ",(0,r.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/NEWMODULE_Adding_capabilities"},"NEWMODULE Adding capabilities"),".")),mdxType:"DbAccessPHP"}),(0,r.kt)("h3",{id:"eventsphp---event-observers"},(0,r.kt)("inlineCode",{parentName:"h3"},"events.php")," - Event observers"),(0,r.kt)(s.tw,{mdxType:"DbEventsPHP"}),(0,r.kt)("h3",{id:"installxml---database-installation"},(0,r.kt)("inlineCode",{parentName:"h3"},"install.xml")," - Database installation"),(0,r.kt)(s.c5,{plugintype:"mod",pluginname:"[modname]",extraDescription:(0,r.kt)(o.Fragment,null,(0,r.kt)("p",null,"Moodle requires that you create a table for your plugin whose name exactly matches the plugin name. For example, the ",(0,r.kt)("inlineCode",{parentName:"p"},"certificate")," activity module ",(0,r.kt)("em",{parentName:"p"},"must")," have a database table named ",(0,r.kt)("inlineCode",{parentName:"p"},"certificate"),". Certain fields within this table are\nalso ",(0,r.kt)("em",{parentName:"p"},"required"),":"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Field name"),(0,r.kt)("th",{parentName:"tr",align:null},"Properties"),(0,r.kt)("th",{parentName:"tr",align:null},"Keys / Indexes"),(0,r.kt)("th",{parentName:"tr",align:null},"Notes"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"id")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"INT(10), auto sequence")),(0,r.kt)("td",{parentName:"tr",align:null},"primary key for the table"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"course")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"INT(10)")),(0,r.kt)("td",{parentName:"tr",align:null},"foreign key to the ",(0,r.kt)("inlineCode",{parentName:"td"},"course")," table"),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"name")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"CHAR(255)")),(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null},"Holds the user-specified name of the activity instance")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"timemodified")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"INT(10)")),(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null},"The timestamp of when the activity was last modified")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"intro")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"TEXT")),(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null},"A standard field to hold the user-defined activity description (see ",(0,r.kt)("inlineCode",{parentName:"td"},"FEATURE_MOD_INTRO"),")")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"introformat")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"INT(4)")),(0,r.kt)("td",{parentName:"tr",align:null}),(0,r.kt)("td",{parentName:"tr",align:null},"A standard field to hold the format of the field"))))),mdxType:"DbInstallXML"}),(0,r.kt)("h3",{id:"upgradephp---upgrade-steps"},(0,r.kt)("inlineCode",{parentName:"h3"},"upgrade.php")," - Upgrade steps"),(0,r.kt)(s.T5,{plugintype:"mod",pluginname:"[modname]",mdxType:"DbUpgradePHP"}),(0,r.kt)("h3",{id:"mobilephp---moodle-mobile-remote-add-ons"},(0,r.kt)("inlineCode",{parentName:"h3"},"mobile.php")," - Moodle Mobile Remote Add-ons"),(0,r.kt)(s.BO,{plugintype:"mod",pluginname:"[modname]",mdxType:"DbMobilePHP"}),(0,r.kt)("h3",{id:"langenmod_modnamephp---language-string-definitions"},(0,r.kt)("inlineCode",{parentName:"h3"},"/lang/en/mod_[modname].php")," - Language string definitions"),(0,r.kt)(s.Uo,{plugintype:"mod",pluginname:"[modname]",filepath:"/lang/en/[modname].php",example:"$string['pluginname'] = 'The name of your activity';",mdxType:"Lang"}),(0,r.kt)("h3",{id:"libphp---library-functions"},(0,r.kt)("inlineCode",{parentName:"h3"},"lib.php")," - Library functions"),(0,r.kt)(s.Gf,{extraDescription:(0,r.kt)("div",null,(0,r.kt)("p",null,"See the ",(0,r.kt)("a",{parentName:"p",href:"https://docs.moodle.org/dev/NEWMODULE_Documentation#lib.php"},"NEWMODULE Documentation#lib.php")," for details on the list of the functions which can be specified in ",(0,r.kt)("inlineCode",{parentName:"p"},"lib.php"),"."),(0,r.kt)("p",null,"For an Activity, you ",(0,r.kt)("em",{parentName:"p"},"must")," define the following three functions, which are described below:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-php",metastring:'title="mod/[modname]/lib.php"',title:'"mod/[modname]/lib.php"'},"function [modname]_add_instance($instancedata, $mform = null): int;\nfunction [modname]_update_instance($instancedata, $mform): bool;\nfunction [modname]_delete_instance($id): bool;\n")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"The ",(0,r.kt)("inlineCode",{parentName:"li"},"[modname]_add_instance()")," function is called when the activity creation form is submitted. This function is only called when adding an activity and should contain any logic required to add the activity."),(0,r.kt)("li",{parentName:"ul"},"The ",(0,r.kt)("inlineCode",{parentName:"li"},"[modname]_update_instance()")," function is called when the activity editing form is submitted."),(0,r.kt)("li",{parentName:"ul"},"The ",(0,r.kt)("inlineCode",{parentName:"li"},"[modname]_delete_instance()")," function is called when the activity deletion is confirmed. It is responsible for removing all data associated with the instance.")),(0,r.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"The ",(0,r.kt)("inlineCode",{parentName:"p"},"lib.php")," file is one of the older parts of Moodle and functionality is gradually being migrated to class-based function calls.")))),mdxType:"Lib"}),(0,r.kt)("h3",{id:"mod_formphp---instance-createedit-form"},(0,r.kt)("inlineCode",{parentName:"h3"},"mod_form.php")," - Instance create/edit form"),(0,r.kt)(h,{mdxType:"ModFormPHP"}),(0,r.kt)("h3",{id:"indexphp---instance-list"},(0,r.kt)("inlineCode",{parentName:"h3"},"index.php")," - Instance list"),(0,r.kt)(y,{mdxType:"IndexPHP"}),(0,r.kt)("h3",{id:"viewphp---view-an-activity"},(0,r.kt)("inlineCode",{parentName:"h3"},"view.php")," - View an activity"),(0,r.kt)(x,{mdxType:"ViewPHP"}),(0,r.kt)("h3",{id:"versionphp"},(0,r.kt)("inlineCode",{parentName:"h3"},"version.php")),(0,r.kt)(s.f_,{plugintype:"mod",pluginname:"[modname]",mdxType:"VersionPHP"}),(0,r.kt)("h2",{id:"see-also"},"See also"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://docs.moodle.org/dev/NEWMODULE_Documentation"},"NEWMODULE Documentation"))))}A.isMDXComponent=!0}}]);